+TITLE.
* GEANF    3.21/04  21/03/95  18.11.33  A.Fasso, A.Ferrari, J.Ranft, P.Sala
+PATCH,$VERSION.
+PATCH,//GEANF/$VERSION.
+DECK,V3_21.
*CMZ :  3.21/04 21/03/95  18.11.33  by  S.Giani
*-- Author :
*
*::>          VERSION  3.21/04   21/03/95 18.11.33
*
*
*::>          VERSION  3.21/03   17/10/94 15.26.00
*
*
*::>          VERSION  3.21/02   25/07/94 15.20.37
*
*
*::>          VERSION  3.21/01   28/03/94 16.10.10
*
*
*::>          VERSION  3.21/00   28/02/94 17.07.10
*
**********************************************************************
*                                                                    *
*                       G E A N T   3 . 2 1                          *
*                                                                    *
*                            C E R N                                 *
*                                                                    *
*                       15/3/94  Geneva  CH                          *
*                                                                    *
**********************************************************************
*
+DECK,V3_16.
*CMZ :          29/03/94  15.41.41  by  S.Giani
*-- Author :
*
*::>          VERSION  3.16/00   07/12/93 14.39.16
*
************************************************************************
*                                                                      *
*    The GEANT-FLUKA interface                                         *
*                                                                      *
*    Since version  3.15, GEANT  includes an interface  with some      *
*    FLUKA [1,2,3,4,5] routines. This  part has been  updated and      *
*    extended in subsequent releases.                                  *
*                                                                      *
*    FLUKA is  a standalone code with  its own life.  Only  a few      *
*    parts have been included into GEANT, namely the ones dealing      *
*    with hadronic elastic and inelastic interactions.                 *
*                                                                      *
*    The  implementation  of FLUKA  routines  in  GEANT does  not      *
*    include  any change,  apart  from interface  ones and  those      *
*    agreed by the FLUKA authors.  Whenever different options are      *
*    available in  FLUKA, the one  suggested by the  authors have      *
*    been retained.  Nevertheless the results obtained with FLUKA      *
*    routines  inside GEANT  could not  be representative  of the      *
*    full  FLUKA performances,  since  they  generally depend  on      *
*    other parts which are GEANT specific.                             *
*                                                                      *
*    The routines made available  for GEANT have been extensively      *
*    tested  and  are reasonably  robust.   They  usually do  not      *
*    represent the latest FLUKA developments, since the policy is      *
*    to supply  for GEANT  well tested  and reliable  code rather      *
*    than very  recent developments with possibly  better physics      *
*    but also still undetected errors.                                 *
*                                                                      *
*    It is important that GEANT users are aware of the conditions      *
*    at which this code has been kindly made available:                *
*                                                                      *
*     o  relevant   authorship   and   references   about   FLUKA      *
*        [1,2,3,4,5]   should  be   clearly   indicated  in   any      *
*        publication reporting results obtained with this code;        *
*                                                                      *
*     o  the FLUKA authors reserve  the right of publishing about      *
*        the  physical  models  they  developed  and  implemented      *
*        inside FLUKA,  GEANT users  are not supposed  to extract      *
*        from  the  GEANT  -  FLUKA code  the  relevant  routines      *
*        running them standalone for benchmarks;                       *
*                                                                      *
*     o  more generally,  FLUKA routines  contained in  the GEANF      *
*        file are  supposed to  be included  and used  with GEANT      *
*        only:  any other  use must  be authorised  by the  FLUKA      *
*        authors.                                                      *
*                                                                      *
*    [1] A.Fasso, A.Ferrari, J.Ranft, P.R.Sala, G.R.Stevenson and      *
*        J.M.Zazula.  FLUKA92.  In Proceedings of the Workshop on      *
*        Simulating Accelerator Radiation Environments, Santa Fe,      *
*        USA, 11-15 January 1993.                                      *
*                                                                      *
*    [2] A.Fasso, A.Ferrari, J.Ranft, P.R.Sala, G.R.Stevenson and      *
*        J.M.Zazula,  "A  Comparison  of FLUKA  Simulations  with      *
*        measurements   of  Fluence   and  Dose   in  Calorimeter      *
*        Structures", Nuclear  Instruments & Methods A,  332, 459      *
*        (1993), (also CERN divisional report CERN/TIS-RP/93-2/PP      *
*        (1993)).                                                      *
*                                                                      *
*    [3] A.Ferrari  and  P.R.Sala,  "A  New  Model  for  hadronic      *
*        interactions  at  intermediate  energies for  the  FLUKA      *
*        code", presented at the  MC93 Int.  Conf. on Monte-Carlo      *
*        Simulation   in   High-Energy   and   Nuclear   Physics,      *
*        Tallahassee, Florida, 22-26 february (1993), Proceedings      *
*        in press.                                                     *
*                                                                      *
*    [4] P.A.Aarnio, A.Fasso,  A.Ferrari, J.-H.Moehring, J.Ranft,      *
*        P.R.Sala, G.R.Stevenson and J.M.Zazula, "FLUKA: hadronic      *
*        benchmarks and applications", presented at the MC93 Int.      *
*        Conf.  on  Monte-Carlo  Simulation  in  High-Energy  and      *
*        Nuclear  Physics, Tallahassee,  Florida, 22-26  february      *
*        (1993), Proceedings in press.                                 *
*                                                                      *
*    [5] P.A.Aarnio, A.Fasso,  A.Ferrari, J.-H.Moehring, J.Ranft,      *
*        P.R.Sala, G.R.Stevenson and J.M.Zazula, "Electron-photon      *
*        transport: always  so good as we  think? Experience with      *
*        FLUKA", presented at the MC93 Int.  Conf. on Monte-Carlo      *
*        Simulation   in   High-Energy   and   Nuclear   Physics,      *
*        Tallahassee, Florida, 22-26 february (1993), Proceedings      *
*        in press.                                                     *
*                                                                      *
************************************************************************
+PATCH,*GEANF.
+DECK,blankdek.
*CMZ :  3.21/02 29/03/94  15.41.41  by  S.Giani
*-- Author :
+USE,GFCDES.
+USE,FLUKA.
+USE,BLOCK.
+USE,PEANUT.
+USE,FIFACE.
+USE,FLUKADAT
+USE, SINGLE,  IF=CDC, CRAY.
+USE, UNIX,    IF=SUN, SGI, DECS, CONVEX, IBMRT, AIX370.
+USE, UNIX,    IF=HPUX, IPSC
+USE, IBMALL,  IF=IBM, IBMMVS, AIX370.
+USE, DOUBLE,  IF=APOLLO, IBMALL, VAX.
+USE, DOUBLE,  IF=UNIX, IF=-SINGLE.
+USE, BSLASH,  IF=SUN, SGI, DECS, IBMRT, IPSC.
 
+PATCH,GFCDES.
+DECK,BLANKDEK
*CMZ :  3.21/02 29/03/94  15.41.41  by  S.Giani
*-- Author :
+KEEP, AUXPAR
C***********************************************************************
C     INCLUDE FILE: AUXPAR COPY                   CREATED 11/12/86 BY PA
C     CHANGES: NONE
C     INCLUDED IN THE FOLLOWING SUBROUTINES OR FUNCTIONS: NOT UPDATED
C
C     DESCRIPTION OF THE COMMON BLOCK(S) AND VARIABLE(S)
C
C***********************************************************************
      PARAMETER (IDMAX6=1133)
      CHARACTER*8 ANA
      COMMON /FKAUXP/PXA(IDMAX6),PYA(IDMAX6),PZA(IDMAX6),HEPA(IDMAX6),
     *AMA(IDMAX6),ICHA(IDMAX6),IBARA(IDMAX6),            NREA(IDMAX6)
      COMMON /FKAUXC/ANA(IDMAX6)
 
+KEEP, BALANC
*                                                                     *
*=== balanc ==========================================================*
*                                                                     *
      LOGICAL LRESMP, LEVDIF, LPRDIF
      COMMON /FKBALA/  ETTOT,  PTTOT, PXTTOT, PYTTOT, PZTTOT,
     &                 EINCP,  EINCN, TVGREY, TVGRE0,  TVEUZ,
     &                   EUZ,    PUX,    PUY,    PUZ,  ENUCR, PXNUCR,
     &                PYNUCR, PZNUCR,  EINTR, PXINTR, PYINTR, PZINTR,
     &                  EFRM,  PXFRM,  PYFRM,  PZFRM,   PSEA,
     &                NGREYP, NGREYN,    ICU,    IBU, ICNUCR, IBNUCR,
     &                ICINTR, IBINTR, LRESMP, LEVDIF, LPRDIF
 
+KEEP, BAMJCM
*
*=== bamjcm ===========================================================*
*
 
*                                                                      *
*----------------------------------------------------------------------*
*                                                                      *
*     Bamjcm by A. Ferrari                                             *
*                           included in:                               *
*                                        bamjet                        *
*     When changing kmxjcm dimension look also at verein!!!!!          *
*----------------------------------------------------------------------*
*                                                                      *
      PARAMETER (KMXJCM = 100)
      COMMON /FKBAMJ/  RPX(KMXJCM),  RPY(KMXJCM),   RE(KMXJCM),
     &                KFR1(KMXJCM), KFR2(KMXJCM),   IV(KMXJCM)
 
 
+KEEP, CMSRES
C***********************************************************************
C     INCLUDE FILE: CMSRES COPY                   CREATED 11/12/86 BY PA
C     CHANGES: NONE
C     INCLUDED IN THE FOLLOWING SUBROUTINES OR FUNCTIONS: NOT UPDATED
C
C     DESCRIPTION OF THE COMMON BLOCK(S) AND VARIABLE(S)
C
C***********************************************************************
      PARAMETER (IDMAX5=1133)
      CHARACTER*8 ANR
      COMMON /FKCMSR/PXR(IDMAX5),PYR(IDMAX5),PZR(IDMAX5),HER(IDMAX5),
     *AMR(IDMAX5),ICHR(IDMAX5),IBARR(IDMAX5),            NRER(IDMAX5),
     *NRES
      COMMON /FKCMSC/ANR(IDMAX5)
 
+KEEP, COMCONT
      DOUBLE PRECISION AOCMBC, CONTNT, SUMACN, CABINX, CABELX,
     &                 ANXNOR, ELXNOR, CONA13, SUMZMF
 
+KEEP, COMCON
*
*=== comcon ===========================================================*
*
*----------------------------------------------------------------------*
*                                                                      *
*     include file: comcon copy                 created 26/11/86 by pa *
*                                                                      *
*     Last change  on  30-oct-92   by   Alfredo Ferrari, INFN - Milan  *
*     included in the following subroutines or functions: not updated  *
*                                                                      *
*     description of the common block(s) and variable(s)               *
*                                                                      *
*                                                                      *
*     /comcon/ contains information about compounds                    *
*         icompl(imat) = number of materials in a compound             *
*         matnum(i)    = material numbers (compounds consist of the    *
*                        materials)                                    *
*         aocmbc(i)    = atomic densities in barn**-1 cm**-1           *
*                        (Atoms Over Cm times Barn for Compounds)      *
*         cona13(i)    = A^1/3 of the constituents                     *
*         sumzmf(i)    = cumulative z^2 for multiple scattering        *
*         contnt(i)    = partial densities                             *
*         sumacn(i)    = cumulative atom contents of the compounds     *
*         cabinx(i)    = cumulative at.cont.*inelastic cross section   *
*         cabelx(i)    = cumulative at.cont.*  elastic cross section   *
*         anxnor       = total inelastic cross section                 *
*         elxnor       = total   elastic cross section                 *
*----------------------------------------------------------------------*
*
      COMMON /FKCOMC/ AOCMBC (ICOMAX), CONA13 (ICOMAX), SUMZMF (ICOMAX),
     &                CONTNT (ICOMAX), SUMACN (ICOMAX), CABINX (ICOMAX),
     &                CABELX (ICOMAX), ANXNOR, ELXNOR,  ICOMPL (MXXMDF),
     &                MATNUM (ICOMAX)
 
+KEEP, CORINC
*                                                                      *
*=== corinc ===========================================================*
*                                                                      *
*----------------------------------------------------------------------*
*                                                                      *
*     Modified by A. Ferrari: be sure that the parameter Inmax is >=   *
*     of the same parameter in the function Nudist                     *
*----------------------------------------------------------------------*
*
      PARAMETER ( INMAX = 20 )
      COMMON /FKCORI/ XSEA (INMAX),  XASEA (INMAX), FRAINC, ANUAV,
     &                IJTARG (INMAX+1), NSEA
 
+KEEP, DBLPRC, IF=DOUBLE
*                                                                     *
*=== dblprc ==========================================================*
*                                                                     *
*---------------------------------------------------------------------*
*                                                                     *
*      Dblprc: included in any routine                                *
*                                                                     *
*  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  *
*  !!!! O N   M A C H I N E S   W H E R E   T H E   D O U B L E !!!!  *
*  !!!! P R E C I S I O N   I S   N O T   R E Q U I R E D  R E -!!!!  *
*  !!!! M O V E   T H E   D O U B L E   P R E C I S I O N       !!!!  *
*  !!!! S T A T E M E N T,  S E T   K A L G N M = 1   A N D     !!!!  *
*  !!!! C H A N G E   A L L   N U M E R I C A L   C O N S -     !!!!  *
*  !!!! T A N T S   T O   S I N G L E   P R E C I S I O N       !!!!  *
*  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  *
*                                                                     *
*         Kalgnm = real address alignment, 2 for double precision,    *
*                  1 for single precision                             *
*         Anglgb = this parameter should be set equal to the machine  *
*                  "zero" with respect to unit                        *
*         Anglsq = this parameter should be set equal to the square   *
*                  of Anglgb                                          *
*         Axcssv = this parameter should be set equal to the number   *
*                  for which unity is negligible for the machine      *
*                  accuracy                                           *
*         Andrfl = "underflow" of the machine for floating point      *
*                  operation                                          *
*         Avrflw = "overflow"  of the machine for floating point      *
*                  operation                                          *
*         Ainfnt = code "infinite"                                    *
*         Azrzrz = code "zero"                                        *
*         Einfnt = natural logarithm of the code "infinite"           *
*         Ezrzrz = natural logarithm of the code "zero"               *
*         Onemns = 1- of the machine, it is 1 - 2 x Anglgb            *
*         Onepls = 1+ of the machine, it is 1 + 2 x Anglgb            *
*         Csnnrm = maximum tolerable error on cosine normalization,   *
*                  u**2+v**2+w**2: assuming a typical anglgb relative *
*                  error on each component we would get 2xanglgb: use *
*                  4xanglgb to avoid too many normalizations          *
*         Dmxtrn = "infinite" distance for transport (cm)             *
*                                                                     *
*---------------------------------------------------------------------*
*                                                                     *
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER ( KALGNM = 2 )
      PARAMETER ( ANGLGB = 5.0D-16 )
      PARAMETER ( ANGLSQ = 2.5D-31 )
      PARAMETER ( AXCSSV = 0.2D+16 )
      PARAMETER ( ANDRFL = 1.0D-38 )
      PARAMETER ( AVRFLW = 1.0D+38 )
      PARAMETER ( AINFNT = 1.0D+30 )
      PARAMETER ( AZRZRZ = 1.0D-30 )
      PARAMETER ( EINFNT = +69.07755278982137 D+00 )
      PARAMETER ( EZRZRZ = -69.07755278982137 D+00 )
      PARAMETER ( ONEMNS = 0.999999999999999  D+00 )
      PARAMETER ( ONEPLS = 1.000000000000001  D+00 )
      PARAMETER ( CSNNRM = 2.0D-15 )
      PARAMETER ( DMXTRN = 1.0D+08 )
*
*======================================================================*
*======================================================================*
*=========                                                   ==========*
*=========    M A T H E M A T I C A L   C O N S T A N T S    ==========*
*=========                                                   ==========*
*======================================================================*
*======================================================================*
*                                                                      *
*   Numerical constants:                                               *
*                                                                      *
*         Zerzer = 0                                                   *
*         Oneone = 1                                                   *
*         Twotwo = 2                                                   *
*         Thrthr = 3                                                   *
*         Foufou = 4                                                   *
*         Fivfiv = 5                                                   *
*         Sixsix = 6                                                   *
*         Sevsev = 7                                                   *
*         Eigeig = 8                                                   *
*         Aninen = 9                                                   *
*         Tenten = 10                                                  *
*         Hlfhlf = 1/2                                                 *
*         Onethi = 1/3                                                 *
*         Twothi = 2/3                                                 *
*         Pipipi = Circumference / diameter                            *
*         Eneper = "e", base of natural logarithm                      *
*         Sqrent = square root of "e"                                  *
*                                                                      *
*----------------------------------------------------------------------*
*
      PARAMETER ( ZERZER = 0.D+00 )
      PARAMETER ( ONEONE = 1.D+00 )
      PARAMETER ( TWOTWO = 2.D+00 )
      PARAMETER ( THRTHR = 3.D+00 )
      PARAMETER ( FOUFOU = 4.D+00 )
      PARAMETER ( FIVFIV = 5.D+00 )
      PARAMETER ( SIXSIX = 6.D+00 )
      PARAMETER ( SEVSEV = 7.D+00 )
      PARAMETER ( EIGEIG = 8.D+00 )
      PARAMETER ( ANINEN = 9.D+00 )
      PARAMETER ( TENTEN = 10.D+00 )
      PARAMETER ( HLFHLF = 0.5D+00 )
      PARAMETER ( ONETHI = ONEONE / THRTHR )
      PARAMETER ( TWOTHI = TWOTWO / THRTHR )
      PARAMETER ( PIPIPI = 3.1415926535897932270 D+00 )
      PARAMETER ( ENEPER = 2.7182818284590452354 D+00 )
      PARAMETER ( SQRENT = 1.6487212707001281468 D+00 )
*
*======================================================================*
*======================================================================*
*=========                                                   ==========*
*=========       P H Y S I C A L   C O N S T A N T S         ==========*
*=========                                                   ==========*
*======================================================================*
*======================================================================*
*                                                                      *
*   Primary constants:                                                 *
*                                                                      *
*         Clight = speed of light in cm s-1                            *
*         Avogad = Avogadro number                                     *
*         Amelgr = electron mass (g)                                   *
*         Plckbr = reduced Planck constant (erg s)                     *
*         Elccgs = elementary charge (CGS unit)                        *
*         Elcmks = elementary charge (MKS unit)                        *
*         Amugrm = Atomic mass unit (g)                                *
*         Ammumu = Muon mass (amu)                                     *
*                                                                      *
*   Derived constants:                                                 *
*                                                                      *
*         Alpfsc = Fine structure constant  = e^2/(hbar c)             *
*         Amelct = Electron mass (GeV) = 10^-16Amelgr Clight^2 / Elcmks*
*         Amugev = Atomic mass unit (GeV) = 10^-16Amelgr Clight^2      *
*                                           / Elcmks                   *
*         Ammuon = Muon mass (GeV) = Ammumu * Amugev                   *
*         Fscto2 = (Fine structure constant)^2                         *
*         Fscto3 = (Fine structure constant)^3                         *
*         Fscto4 = (Fine structure constant)^4                         *
*         Plabrc = Reduced Planck constant times the light velocity    *
*                  expressed in GeV fm                                 *
*         Rclsel = Classical electron radius (cm) = e^2 / (m_e c^2)    *
*   Conversion constants:                                              *
*         GeVMeV = from GeV to MeV                                     *
*         eMVGeV = from MeV to GeV                                     *
*         Raddeg = from radians to degrees                             *
*         Degrad = from degrees to radians                             *
*                                                                      *
*----------------------------------------------------------------------*
*
      PARAMETER ( CLIGHT = 2.99792458         D+10 )
      PARAMETER ( AVOGAD = 6.0221367          D+23 )
      PARAMETER ( AMELGR = 9.1093897          D-28 )
      PARAMETER ( PLCKBR = 1.05457266         D-27 )
      PARAMETER ( ELCCGS = 4.8032068          D-10 )
      PARAMETER ( ELCMKS = 1.60217733         D-19 )
      PARAMETER ( AMUGRM = 1.6605402          D-24 )
      PARAMETER ( AMMUMU = 0.113428913        D+00 )
*     PARAMETER ( ALPFSC = 1.D+00 / 137.035989561D+00 )
*     PARAMETER ( FSCTO2 = ALPFSC * ALPFSC )
*     PARAMETER ( FSCTO3 = FSCTO2 * ALPFSC )
*     PARAMETER ( FSCTO4 = FSCTO3 * ALPFSC )
*    It is important to set the electron mass exactly with the same
*    rounding as in the mass tables, so use the explicit expression
*     PARAMETER ( AMELCT = 1.D-16 * AMELGR * CLIGHT * CLIGHT / ELCMKS )
*    It is important to set the amu mass exactly with the same
*    rounding as in the mass tables, so use the explicit expression
*     PARAMETER ( AMUGEV = 1.D-16 * AMUGRM * CLIGHT * CLIGHT / ELCMKS )
*    It is important to set the muon mass exactly with the same
*    rounding as in the mass tables, so use the explicit expression
*     PARAMETER ( AMMUON = AMMUMU * AMUGEV ELCMKS )
*     PARAMETER ( RCLSEL = ELCCGS * ELCCGS / CLIGHT / CLIGHT / AMELGR )
      PARAMETER ( ALPFSC = 7.2973530791728595 D-03 )
      PARAMETER ( FSCTO2 = 5.3251361962113614 D-05 )
      PARAMETER ( FSCTO3 = 3.8859399018437826 D-07 )
      PARAMETER ( FSCTO4 = 2.8357075508200407 D-09 )
      PARAMETER ( PLABRC = 0.197327053        D+00 )
      PARAMETER ( AMELCT = 0.51099906         D-03 )
      PARAMETER ( AMUGEV = 0.93149432         D+00 )
      PARAMETER ( AMMUON = 0.105658389        D+00 )
      PARAMETER ( RCLSEL = 2.8179409183694872 D-13 )
      PARAMETER ( GEVMEV = 1.0                D+03 )
      PARAMETER ( EMVGEV = 1.0                D-03 )
      PARAMETER ( RADDEG = 180.D+00 / PIPIPI )
      PARAMETER ( DEGRAD = PIPIPI / 180.D+00 )
 
+KEEP, DBLPRC, IF=SINGLE
      IMPLICIT REAL (A-H,O-Z)
      PARAMETER ( KALGNM = 1 )
      PARAMETER ( ANGLGB = 5.0e-16 )
      PARAMETER ( ANGLSQ = 2.5e-31 )
      PARAMETER ( AXCSSV = 0.2e+16 )
      PARAMETER ( ANDRFL = 1.0e-38 )
      PARAMETER ( AVRFLW = 1.0e+38 )
      PARAMETER ( AINFNT = 1.0e+30 )
      PARAMETER ( AZRZRZ = 1.0e-30 )
      PARAMETER ( EINFNT = +69.07755278982137 e+00 )
      PARAMETER ( EZRZRZ = -69.07755278982137 e+00 )
      PARAMETER ( ONEMNS = 0.999999999999999  e+00 )
      PARAMETER ( ONEPLS = 1.000000000000001  e+00 )
      PARAMETER ( CSNNRM = 2.0e-15 )
      PARAMETER ( DMXTRN = 1.0e+08 )
*
      PARAMETER ( ZERZER = 0.e+00 )
      PARAMETER ( ONEONE = 1.e+00 )
      PARAMETER ( TWOTWO = 2.e+00 )
      PARAMETER ( THRTHR = 3.e+00 )
      PARAMETER ( FOUFOU = 4.e+00 )
      PARAMETER ( FIVFIV = 5.e+00 )
      PARAMETER ( SIXSIX = 6.e+00 )
      PARAMETER ( SEVSEV = 7.e+00 )
      PARAMETER ( EIGEIG = 8.e+00 )
      PARAMETER ( ANINEN = 9.e+00 )
      PARAMETER ( TENTEN = 10.e+00 )
      PARAMETER ( HLFHLF = 0.5e+00 )
      PARAMETER ( ONETHI = ONEONE / THRTHR )
      PARAMETER ( TWOTHI = TWOTWO / THRTHR )
      PARAMETER ( PIPIPI = 3.1415926535897932270 e+00 )
      PARAMETER ( ENEPER = 2.7182818284590452354 e+00 )
      PARAMETER ( SQRENT = 1.6487212707001281468 e+00 )
*
      PARAMETER ( CLIGHT = 2.99792458         e+10 )
      PARAMETER ( AVOGAD = 6.0221367          e+23 )
      PARAMETER ( AMELGR = 9.1093897          e-28 )
      PARAMETER ( PLCKBR = 1.05457266         e-27 )
      PARAMETER ( ELCCGS = 4.8032068          e-10 )
      PARAMETER ( ELCMKS = 1.60217733         e-19 )
      PARAMETER ( AMUGRM = 1.6605402          e-24 )
      PARAMETER ( AMMUMU = 0.113428913        e+00 )
*     PARAMETER ( ALPFSC = 1.e+00 / 137.035989561e+00 )
*     PARAMETER ( FSCTO2 = ALPFSC * ALPFSC )
*     PARAMETER ( FSCTO3 = FSCTO2 * ALPFSC )
*     PARAMETER ( FSCTO4 = FSCTO3 * ALPFSC )
*    It is important to set the electron mass exactly with the same
*    rounding as in the mass tables, so use the explicit expression
*     PARAMETER ( AMELCT = 1.e-16 * AMELGR * CLIGHT * CLIGHT / ELCMKS )
*    It is important to set the amu mass exactly with the same
*    rounding as in the mass tables, so use the explicit expression
*     PARAMETER ( AMUGEV = 1.e-16 * AMUGRM * CLIGHT * CLIGHT / ELCMKS )
*    It is important to set the muon mass exactly with the same
*    rounding as in the mass tables, so use the explicit expression
*     PARAMETER ( AMMUON = AMMUMU * AMUGEV ELCMKS )
*     PARAMETER ( RCLSEL = ELCCGS * ELCCGS / CLIGHT / CLIGHT / AMELGR )
      PARAMETER ( ALPFSC = 7.2973530791728595 e-03 )
      PARAMETER ( FSCTO2 = 5.3251361962113614 e-05 )
      PARAMETER ( FSCTO3 = 3.8859399018437826 e-07 )
      PARAMETER ( FSCTO4 = 2.8357075508200407 e-09 )
      PARAMETER ( PLABRC = 0.197327053        e+00 )
      PARAMETER ( AMELCT = 0.51099906         e-03 )
      PARAMETER ( AMUGEV = 0.93149432         e+00 )
      PARAMETER ( AMMUON = 0.105658389        e+00 )
      PARAMETER ( RCLSEL = 2.8179409183694872 e-13 )
      PARAMETER ( GEVMEV = 1.0                e+03 )
      PARAMETER ( EMVGEV = 1.0                e-03 )
      PARAMETER ( RADDEG = 180.e+00 / PIPIPI )
      PARAMETER ( DEGRAD = PIPIPI / 180.e+00 )
 
+KEEP, DECAYC
C***********************************************************************
C     INCLUDE FILE: DECAYC COPY                   CREATED 12/12/86 BY PA
C     NOTE: SEE ALSO DECAYC2 COPY
C     CHANGES: NONE
C     INCLUDED IN THE FOLLOWING SUBROUTINES OR FUNCTIONS: NOT UPDATED
C
C     DESCRIPTION OF THE COMMON BLOCK(S) AND VARIABLE(S)
C
C***********************************************************************
      PARAMETER (IDMAX9=540)
      CHARACTER*8 ZKNAME
      COMMON/FKDECC/ NZK(IDMAX9,3),WT(IDMAX9)
      COMMON/FKDECH/ ZKNAME(IDMAX9)
 
+KEEP, DECAYC2
C***********************************************************************
C     INCLUDE FILE: DECAYC2 COPY                   CREATED 12/12/86 BY A
C     NOTE: SEE ALSO DECAYC COPY
C     CHANGES: NONE
C     INCLUDED IN THE FOLLOWING SUBROUTINES OR FUNCTIONS: NOT UPDATED
C
C     DESCRIPTION OF THE COMMON BLOCK(S) AND VARIABLE(S)
C
C***********************************************************************
      PARAMETER (IDMAX9=540)
      CHARACTER*8 ZKNAMC
      COMMON /FKDECC/ NZKC(IDMAX9,3),WTC(IDMAX9)
      COMMON/FKDECH/ ZKNAMC(IDMAX9)
 
+KEEP, DEPNUC
*                                                                     *
*=== depnuc ==========================================================*
*                                                                     *
      LOGICAL LLASTN, LLAST1
      COMMON /FKDEPN/    EKLAST, AMLAST, PXLAST, PYLAST, PZLAST,
     &                   EKINC , AMINC , PXXINC, PYYINC, PZZINC,
     &                   KTLAST, KTINC , LLASTN, LLAST1
 
+KEEP, DIMPAR
*                                                                     *
*=== dimpar ==========================================================*
*                                                                     *
*---------------------------------------------------------------------*
*                                                                     *
*      DIMPAR: included in any routine                                *
*                                                                     *
*          Mxxrgn = maximum number of regions                         *
*          Mxxmdf = maximum number of media in Fluka                  *
*          Mxxmde = maximum number of media in Emf                    *
*          Mfstck = stack dimension in Fluka                          *
*          Mestck = stack dimension in Emf                            *
*          Nallwp = number of allowed particles                       *
*          Mpdpdx = number of particle types for which EM dE/dx pro-  *
*                   cesses (ion,pair,bremss) have to be computed      *
*          Icomax = maximum number of materials for compounds (equal  *
*                   to the sum of the number of materials for every   *
*                   compound )                                        *
*          Nstbis = number of stable isotopes recorded in common iso- *
*                   top                                               *
*                                                                     *
*---------------------------------------------------------------------*
*                                                                     *
      PARAMETER ( MXXRGN = 500  )
      PARAMETER ( MXXMDF = 50   )
      PARAMETER ( MXXMDE = 18   )
      PARAMETER ( MFSTCK = 1000 )
      PARAMETER ( MESTCK = 100  )
      PARAMETER ( NALLWP = 39   )
      PARAMETER ( MPDPDX = 8    )
      PARAMETER ( ICOMAX = 120  )
      PARAMETER ( NSTBIS = 304  )
 
+KEEP, FHEAVYT
      DOUBLE PRECISION CXHEAV, CYHEAV, CZHEAV, TKHEAV, PHEAVY,
     &                 WHEAVY, AMHEAV
 
+KEEP, FHEAVY
*
*=== fheavy ===========================================================*
*
*----------------------------------------------------------------------*
*     Last change on 9 March 1993     by Alfredo Ferrari, INFN Milan   *
*     include file: fheavy copy       created 5/4/90 by A. Ferrari     *
*     changes: none                                                    *
*     included in the following subroutines or functions: not updated  *
*                                                                      *
*     description of the common block(s) and variable(s)               *
*                                                                      *
*     /fheavy/ is the storage for heavy secondaries created in the     *
*              nuclear evaporation                                     *
*        npheav     = number of secondaries                            *
*        kheavy(ip) = type of the secondary ip                         *
*                   ( 3 = deuteron, 4 = 3-H, 5 = 3-He, 6 = 4-He,       *
*                     7-12 = "Heavy" fragment specified by Ibheav and  *
*                     Icheav )                                         *
*        cxheav(ip) = direction cosine of the secondary ip             *
*                     with respect to x-axis                           *
*        cyheav(ip) = direction cosine of the secondary ip             *
*                     with respect to y-axis                           *
*        czheav(ip) = direction cosine of the secondary ip             *
*                     with respect to z-axis                           *
*        tkheav(ip) = kinetic energy of secondary ip                   *
*        pheavy(ip) = momentum of the secondary ip                     *
*        wheavy(ip) = weight of the secondary ip                       *
*        amheav(ip) = atomic masses of the six types of evaporated     *
*                     particles                                        *
*        anheav(kp) = name of the kp-type heavy particle               *
*        icheav(kp) = charge of the kp-type heavy particle             *
*        ibheav(kp) = mass number of the kp-type heavy particle        *
*   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!   *
*   !!! There is now the possibility to produce up to 6 "heavy" !!!!   *
*   !!! fragments besides the residual nucleus recorded in      !!!!   *
*   !!! Resnuc: they are identified by indeces 7-12, of course  !!!!   *
*   !!! the corresponding physical properties (Z,A,m..) must be !!!!   *
*   !!! updated every time they are produced                    !!!!   *
*   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!   *
*----------------------------------------------------------------------*
*
      PARAMETER ( MXHEAV = 100 )
      CHARACTER*8 ANHEAV
      COMMON / FKHEAV / CXHEAV (MXHEAV), CYHEAV (MXHEAV),
     &                  CZHEAV (MXHEAV), TKHEAV (MXHEAV),
     &                  PHEAVY (MXHEAV), WHEAVY (MXHEAV),
     &                  AMHEAV  ( 12 ) ,
     &                  KHEAVY (MXHEAV), ICHEAV  ( 12 ) ,
     &                  IBHEAV  ( 12 ) , NPHEAV
      COMMON / FKHEAC / ANHEAV  ( 12 )
 
+KEEP, FINLSP
C***********************************************************************
C     INCLUDE FILE: FINLSP COPY                   CREATED 11/12/86 BY PA
C     NOTE: SEE ALSO FILE FINLSP2 COPY
C     CHANGES: NONE
C     INCLUDED IN THE FOLLOWING SUBROUTINES OR FUNCTIONS: NOT UPDATED
C
C     DESCRIPTION OF THE COMMON BLOCK(S) AND VARIABLE(S)
C
C***********************************************************************
      PARAMETER (IDMAX7=100)
      COMMON/FKFINL/ CXR(IDMAX7),CYR(IDMAX7),CZR(IDMAX7),
     *ELR(IDMAX7),PLR(IDMAX7),IR,ITR(IDMAX7)
 
+KEEP, FINLSP2
C***********************************************************************
C     INCLUDE FILE:  FINLSP2 COPY               CREATED 11/12/86 BY PA A
C     NOTE: SEE ALSO FILE FINLSP COPY
C     CHANGES: NONE
C     INCLUDED IN THE FOLLOWING SUBROUTINES OR FUNCTIONS: NOT UPDATED
C
C     DESCRIPTION OF THE COMMON BLOCK(S) AND VARIABLE(S)
C
C***********************************************************************
      PARAMETER (IDMAX7=100)
      COMMON/FKFINL/CXR(IDMAX7),CYR(IDMAX7),CZR(IDMAX7),
     *EL(IDMAX7),PL(IDMAX7),IR,ITR(IDMAX7)
 
+KEEP, FINLSP3
C***********************************************************************
C     include file:  finlsp3 copy           Created 4/9/89 by A. Ferrari
C     note: see also file finlsp copy and finlsp2
C     changes: none
C     included in the following subroutines or functions:
C                                                         Eventq
C
C     description of the common block(s) and variable(s)
C
C***********************************************************************
      PARAMETER (IDMAX7=100)
      COMMON/FKFINL/CXH(IDMAX7),CYH(IDMAX7),CZH(IDMAX7),
     *ELH(IDMAX7),PLH(IDMAX7),IH,ITH(IDMAX7)
 
+KEEP, FINPAR
C***********************************************************************
C     INCLUDE FILE: FINPAR COPY                   CREATED 11/12/86 BY PA
C     NOTE: DO NOT FORGET FILE FINPAR2 COPY
C     CHANGES: NONE
C     INCLUDED IN THE FOLLOWING SUBROUTINES OR FUNCTIONS: NOT UPDATED
C
C     DESCRIPTION OF THE COMMON BLOCK(S) AND VARIABLE(S)
C
C***********************************************************************
      PARAMETER (IDMAX1=1133)
      CHARACTER*8 ANF
      COMMON /FKFINP/PXF(IDMAX1),PYF(IDMAX1),PZF(IDMAX1),HEP(IDMAX1),
     *AMF(IDMAX1),ICHF(IDMAX1),IBARF(IDMAX1),NREF(IDMAX1)
      COMMON /FKFINC/ ANF(IDMAX1)
 
+KEEP, FINPAR2
C***********************************************************************
C     INCLUDE FILE: FINPAR2 COPY                   CREATED 11/12/86 BY A
C     NOTE: DO NOT FORGET FILE FINPAR COPY
C     CHANGES: NONE
C     INCLUDED IN THE FOLLOWING SUBROUTINES OR FUNCTIONS: NOT UPDATED
C
C     DESCRIPTION OF THE COMMON BLOCK(S) AND VARIABLE(S)
C
C***********************************************************************
      PARAMETER (IDMAX3=1133)
      CHARACTER*8 ANF
      COMMON /FKFINP/PXF(IDMAX3),PYF(IDMAX3),PZF(IDMAX3),HEF(IDMAX3),
     *AMF(IDMAX3),ICHF(IDMAX3),IBARF(IDMAX3),NREF(IDMAX3)
      COMMON /FKFINC/ ANF(IDMAX3)
 
+KEEP, FINUCT
      DOUBLE PRECISION CXR, CYR, CZR, TKI, PLR, WEI, TV, TVCMS,
     &                 TVRECL, TVHEAV, TVBIND
 
+KEEP, FINUC
*
*=== finuc ============================================================*
*
*----------------------------------------------------------------------*
*     Last change on 5 april 1990     by Alfredo Ferrari, INFN Milan   *
*     include file: finuc copy                   created 26/11/86 by pa*
*     note: if changed change finuc2 copy also                         *
*     changes: none                                                    *
*     included in the following subroutines or functions: not updated  *
*                                                                      *
*     description of the common block(s) and variable(s)               *
*                                                                      *
*     /finuc/ is the storage for secondaries created in event          *
*        np        = number of secondaries                             *
*        kpart(ip) = type of the secondary ip                          *
*        cxr(ip)   = direction cosine of the secondary ip              *
*                    with respect to x-axis                            *
*        cyr(ip)   = direction cosine of the secondary ip              *
*                    with respect to y-axis                            *
*        czr(ip)   = direction cosine of the secondary ip              *
*                    with respect to z-axis                            *
*        tki(ip)   = kinetic energy of secondary ip                    *
*        plr(ip)   = momentum of the secondary ip                      *
*        wei(ip)   = weight of the secondary ip                        *
*        tv        = excitation energy                                 *
*        tvcms     = actual excitation energy of the residual nucleus  *
*        tvrecl    = recoil kinetic energy of the residual nucleus     *
*        tvheav    = recoil kinetic energies of heavy (2-H, 3-H, 3-He, *
*                    4-He) fragments after evaporation                 *
*        tvbind    = approximate energy wasted in nuclear binding      *
*                    effects
*----------------------------------------------------------------------*
*
      PARAMETER (MXP=999)
      COMMON / FKFINU / CXR (MXP), CYR (MXP), CZR (MXP), TKI (MXP),
     &                 PLR (MXP), WEI (MXP), TV, TVCMS, TVRECL, TVHEAV,
     &                 TVBIND, NP0, NP, KPART (MXP)
 
+KEEP, FINUC2
*
*=== finuc2 ===========================================================*
*
*----------------------------------------------------------------------*
*     Last change on 5 april 1990 by   Alfredo Ferrari, INFN - Milan   *
*     include file: finuc2 copy                  created 26/11/86 by pa*
*     note: if changed change finuc copy also                          *
*     changes: none                                                    *
*     included in the following subroutines or functions: not updated  *
*                                                                      *
*     description of the common block(s) and variable(s)               *
*                                                                      *
*     /finuc/ is the storage for secondaries created in event          *
*        irn       = number of secondaries                             *
*        itrn(ip)  = type of the secondary ip                          *
*        cxrn(ip)  = direction cosine of the secondary ip              *
*                    with respect to x-axis                            *
*        cyrn(ip)  = direction cosine of the secondary ip              *
*                    with respect to y-axis                            *
*        czrn(ip)  = direction cosine of the secondary ip              *
*                    with respect to z-axis                            *
*        elr(ip)   = kinetic (or total) energy of secondary ip         *
*        plr(ip)   = momentum of the secondary ip                      *
*        wei(ip)   = weight of the secondary ip                        *
*        tv        = excitation energy                                 *
*        tvcms     = actual excitation energy of the residual nucleus  *
*        tvrecl    = recoil kinetic energy of the residual nucleus     *
*        tvheav    = recoil kinetic energies of heavy (2-H, 3-H, 3-He, *
*                    4-He) fragments after evaporation                 *
*        tvbind    = approximate energy wasted in nuclear binding      *
*                    effects
*----------------------------------------------------------------------*
*
      PARAMETER (MXP=999)
      COMMON / FKFINU / CXRN (MXP), CYRN (MXP), CZRN (MXP), ELR (MXP),
     &                 PLR  (MXP), WEI  (MXP), TV, TVCMS, TVRECL,
     &                 TVHEAV, TVBIND, NP0, IRN, ITRN (MXP)
 
+KEEP, HADFLG
*
*=== hadflg ===========================================================*
*
*
*----------------------------------------------------------------------*
*                                                                      *
*     Created on 13 september 1991 by    Alfredo Ferrari & Paola Sala  *
*                                                   Infn - Milan       *
*                                                                      *
*     Last change on  1-dec-91     by    Alfredo Ferrari               *
*                                                                      *
*     Included in the following routines:                              *
*                                                                      *
*                                         Calumo                       *
*                                         Datesh                       *
*                                         Eventv                       *
*                                         Ferhav                       *
*                                         Hadriv                       *
*                                         Rchanv                       *
*                                                                      *
*                    Ielflg = Flag to control the elastic channel      *
*                             in Hadriv:                               *
*                             -1: elastic channel reduced according    *
*                                 to a rough Pauli blocking factor     *
*                              0: elastic channel fully accounted for  *
*                             +1: elastic channel suppressed           *
*                    Icxflg = Flag to control the charge exchange      *
*                             channel in Hadriv:                       *
*                             -1: ch. ex. channel reduced according    *
*                                 to a rough Pauli blocking factor     *
*                              0: ch. ex. channel fully accounted for  *
*                             +1: ch. ex. channel suppressed           *
*             Innure(1,1,k) = Projectile index for the Hadriv reaction *
*                             k (first entrance channel)               *
*             Innure(2,1,k) = Target index for the Hadriv reaction     *
*                             k (first entrance channel)               *
*             Innure(1,2,k) = Projectile index for the Hadriv reaction *
*                             k (second entrance channel, if any)      *
*             Innure(2,2,k) = Target index for the Hadriv reaction     *
*                             k (second entrance channel, if any)      *
*                             It holds:                                *
*                        Nure (Innure(1,j,k),(Innure(2,j,k)/8+1)) = k  *
*                                                                      *
*----------------------------------------------------------------------*
*
      PARAMETER ( PPAMXB = 0.6       D+00 )
      PARAMETER ( PAUMXB = 2.D+00 * 0.8 D+00 )
      PARAMETER ( PPAMXM = 0.6       D+00 )
      PARAMETER ( PAUMXM = 2.D+00 * 0.4 D+00 )
*
      COMMON / FKHADF / IELFLG, ICXFLG, IKCHXG (16), INNURE (2,2,16),
     &                  IOLDHD
 
+KEEP, HADPAR
C***********************************************************************
C     INCLUDE FILE: HADPAR COPY                   CREATED 11/12/86 BY PA
C     CHANGES: NONE
C     INCLUDED IN THE FOLLOWING SUBROUTINES OR FUNCTIONS: NOT UPDATED
C
C     DESCRIPTION OF THE COMMON BLOCK(S) AND VARIABLE(S)
C
C***********************************************************************
      PARAMETER (IDMAX4=1133)
      CHARACTER*8 ANH
      COMMON /FKHADP/PXH(IDMAX4),PYH(IDMAX4),PZH(IDMAX4),HEPH(IDMAX4),
     *AMH(IDMAX4),ICHH(IDMAX4),IBARH(IDMAX4),            NREH(IDMAX4)
      COMMON /FKHADC/ANH(IDMAX4)
 
+KEEP, HIGFIS
*
*=== higfis ===========================================================*
*
*----------------------------------------------------------------------*
*                                                                      *
*     HIGh energy FISsion common:                                      *
*                                                                      *
*     Created   on   9 april 1993   by   Alfredo Ferrari & Paola Sala  *
*                                             INFN - Milan             *
*     Last change on   11-apr-93    by   Alfredo Ferrari, INFN - Milan *
*                                                                      *
*          Fisinh = logical flag for HE fission                        *
*          Afis(i)= ith fragment mass number just after fission        *
*          Zfis(i)= ith fragment atomic number just after fission      *
*          Ufis(i)= ith fragment excitation energy (MeV) just after    *
*                   fission                                            *
*         Ekfis(i)= ith fragment kinetic(MeV) energy just after fission*
*         Amfis(i)= ith fragment atomic mass (MeV) just after fission  *
*         Ppfis(i)= ith fragment momentum (MeV/c) just after fission   *
*         Atfis(i)= ith fragment mass number after evaporation         *
*         Ztfis(i)= ith fragment atomic number after evaporation       *
*         Utfis(i)= ith fragment excitation energy (MeV) after evapora-*
*                   tion                                               *
*        Recfis(i)= ith fragment kinetic(MeV) energy after evaporation *
*        Atmfis(i)= ith fragment atomic mass (MeV) after evaporation   *
*        Pptfis(i)= ith fragment momentum (MeV/c) after evaporation    *
*          Ebfiss = fission barrier (MeV)                              *
*          Amdiff = Fission fragment kinetic energy (MeV)              *
*            Apr0 = Mass number of the (first) fissioning nucleus      *
*            Zpr0 = Atomic number of the (first) fissioning nucleus    *
*             Uu0 = Excitation energy (MeV) of the (first) fissioning  *
*                   nucleus                                            *
*           Erec0 = Recoil kinetic energy (MeV) of the (first) fissio- *
*                   ning nucleus                                       *
*      Npartf(j,i)= Number of evaporated particle of type j after the  *
*                   evaporation of the ith fragment                    *
*        Hevfis(i)= Evaporated "heavies" kinetic energy (MeV) after the*
*                   evaporation of the ith fragment                    *
*           Nfiss = Number of fission fragments in the stack           *
*                                                                      *
*----------------------------------------------------------------------*
*
      LOGICAL FISINH
      COMMON / FKHIGF / AFIS  (10), ZFIS  (10), UFIS  (10), EKFIS  (10),
     &                  AMFIS (10), PPFIS (10), COSLFF(3,0:10),
     &                  ATFIS (10), ZTFIS (10), UTFIS (10), RECFIS (10),
     &                  AMTFIS(10), PPTFIS(10), EBFISS, AMDIFF,
     &                  APR0, ZPR0, EREC0, UU0, HEVFIS (0:10),
     &                  NPARTF (6,0:10), NFISS, FISINH
      DIMENSION COSLF0 (3)
      EQUIVALENCE ( COSLF0 (1), COSLFF (1,0) )
+KEEP, INPDAT
*
*=== inpdat ===========================================================*
*
*----------------------------------------------------------------------*
*     include file: inpdat copy          Created 22/12/86 by PA Aarnio
*     changes: revised 29/3/90 by A. Ferrari
*     included in the following subroutines or functions: not updated
*
*     N O W   T H E R E   I S   A   C O P Y   O F   I N P D A T
*     (  I N P D A T 2  )   C R E A T E D
*     T O   A V O I D   T O   D I R T Y   T H E   B A M J E T
*     P A R A M E T E R S !!!!!!!!!!!!
*
*     description of the common block(s) and variable(s)
*
*----------------------------------------------------------------------*
*
      COMMON /FKINPD/ A1, B1, B2, B3, BET, AS, B8, AME, DIQ, IMPS(6,6),
     &                IMVE(6,6),  IB08(6,21), IB10(6,21), IA08(6,21),
     &                IA10(6,21), LT, LE, ISU
 
+KEEP, INPDAT2
*
*=== inpdat2 ==========================================================*
*
*----------------------------------------------------------------------*
*     include file: inpdat2 copy          created 29/3/90 by A. Ferrari
*     changes: none
*     included in the following subroutines or functions: not updated
*
*     T H I S   I S   A   C O P Y   O F   I N P D A T   C R E A T E D
*     T O   A V O I D   T O   D I R T Y   T H E   B A M J E T
*     P A R A M E T E R S !!!!!!!!!!!!
*
*     description of the common block(s) and variable(s)
*
*----------------------------------------------------------------------*
*
      COMMON /FKINPD/ A1BAMJ, B1BAMJ, B2BAMJ, B3BAMJ, BETBAM, ASBAMJ,
     &                B8BAMJ, AMEBAM, DIQBAM, IMPS (6,6), IMVE (6,6),
     &                IB08 (6,21), IB10 (6,21), IA08 (6,21),
     &                IA10 (6,21), LTBAMJ, LEBAMJ, ISUBAM
 
+KEEP, IOUNIT
*                                                                     *
*=== iounit ==========================================================*
*                                                                     *
*---------------------------------------------------------------------*
*                                                                     *
*      Iounit: included in any routine                                *
*                                                                     *
*         lunin  = standard input unit                                *
*         lunout = standard output unit                               *
*         lunerr = standard error unit                                *
*         lunber = input file for bertini nuclear data                *
*         lunech = echo file for pegs dat                             *
*         lunflu = input file for photoelectric edges and X-ray fluo- *
*                  rescence data                                      *
*         lungeo = scratch file for combinatorial geometry            *
*         lunpgs = input file for pegs material data                  *
*         lunran = output file for the final random number seed       *
*         lunxsc = input file for low energy neutron cross sections   *
*                                                                     *
*---------------------------------------------------------------------*
*                                                                     *
      PARAMETER ( LUNIN  = 5  )
      PARAMETER ( LUNOUT = 6  )
      PARAMETER ( LUNERR = 66 )
      PARAMETER ( LUNBER = 22 )
      PARAMETER ( LUNECH = 8  )
      PARAMETER ( LUNFLU = 86 )
      PARAMETER ( LUNGEO = 16 )
      PARAMETER ( LUNPGS = 12 )
      PARAMETER ( LUNRAN = 2  )
      PARAMETER ( LUNXSC = 81 )
 
+KEEP, ISOTOP
*----------------------------------------------------------------------*
*     include file: isotop          created by A. Ferrari on 23-9-90   *
*                                                                      *
*     description of the common block(s) and variable(s)               *
*                                                                      *
*                                                                      *
*        isondx = initial and final indexes in the abuiso and isomnm   *
*                 for a given atomic number                            *
*        isomnm = mass numbers of the isotopes                         *
*        abuiso = natural abundances of the isotopes                   *
*        astlin(1,iz) = "average" A of the stability line versus the   *
*                       atomic number Z                                *
*        astlin(2,iz) = dispersion of A of the stability line versus   *
*                       the atomic number Z                            *
*        zstlin(1,ia) = "average" Z of the stability line versus the   *
*                       mass number A                                  *
*        zstlin(2,ia) = dispersion of Z of the stability line versus   *
*                       the mass number A                              *
*                                                                      *
*----------------------------------------------------------------------*
*
      COMMON / FKISOT / ABUISO (NSTBIS), ASTLIN (2,100), ZSTLIN (2,260),
     &                  ISOMNM (NSTBIS), ISONDX (2,100)
 
+KEEP, MAPAT
 
      DOUBLE PRECISION  AOCMBM , AMSS , ZTAR   , RHO    , ZLIN , ZLEL
     &                , ZLRAD  , ZUL
 
+KEEP, MAPA
*----------------------------------------------------------------------*
*     include file: mapa copy                    created 26/11/86 by pa*
*     note: change also mapa2 copy if you touch this file              *
*     changes: none                                                    *
*     included in the following subroutines or functions: not updated  *
*                                                                      *
*     description of the common block(s) and variable(s)               *
*                                                                      *
*                                                                      *
*     /mapa/ contains the parameters describing the target materials   *
*        matnam = matnam(i)=name of the material number i              *
*        medium = medium(nreg)=material number of the region nreg      *
*        amss   = the atomic weight of the materials                   *
*        aocmbm = atomic densities in barn**-1 cm**-1                  *
*                 (Atoms Over Cm times Barn for Materials)             *
*        ztar   = atomic numbers of the materials                      *
*        rho    = densities of the materials                           *
*        zlin   = inelastic scattering lengths of the materials        *
*                 for beam particles at the average beam energy in cm  *
*        zlel   = elastic scattering lengths of the materials for      *
*                 beam particles at average beam energy in cm          *
*        zlrad  = radiation lengths of the materials in cm             *
*        zul    = inelastic scattering lengths of the materials        *
*                 for neutrons at threshold energy in cm               *
*        mulflg = flags for multiple scattering options                *
*        icomp  = 0 if the material is not a compound                  *
*        mssnum = mass number of the target nucleus, if =< 0 it means  *
*                 that it is in the natural isotopic composition       *
*        nregs  = total number of the regions                          *
*        nmat   = total number of the materials                        *
*        mtbsnm = medium for which inelastic interaction biasing must  *
*                 be done                                              *
*                                                                      *
*                        Mxxrgn = maximum number of regions            *
*                                                                      *
*----------------------------------------------------------------------*
*
      COMMON / FKMAPA / AOCMBM (MXXMDF), AMSS (MXXMDF), ZTAR   (MXXMDF),
     &                  RHO    (MXXMDF), ZLIN (MXXMDF), ZLEL   (MXXMDF),
     &                  ZLRAD  (MXXMDF), ZUL  (MXXMDF), MEDIUM (MXXRGN),
     &                  MULFLG (MXXMDF), ICOMP(MXXMDF), MSSNUM (MXXMDF),
     &                  NREGS, NMAT, MTBSNM
 
+KEEP, METLSP
C***********************************************************************
C     INCLUDE FILE: METLSP COPY                   CREATED 11/12/86 BY PA
C     CHANGES: NONE
C     INCLUDED IN THE FOLLOWING SUBROUTINES OR FUNCTIONS: NOT UPDATED
C
C     DESCRIPTION OF THE COMMON BLOCK(S) AND VARIABLE(S)
C
C***********************************************************************
      PARAMETER (IDMAX2=1133)
      COMMON/FKMETL/ IS,ITS(IDMAX2),CXS(IDMAX2),CYS(IDMAX2),CZS(IDMAX2),
     *ELS(IDMAX2),PLS(IDMAX2)
 
+KEEP, NUCDAT
*                                                                     *
*=== nucdat ==========================================================*
*                                                                     *
*---------------------------------------------------------------------*
*                                                                     *
*     Include file Nucdat                                             *
*                                                                     *
*     Created on 20 april 1990  by            Alfredo Ferrari         *
*                                               INFN Milan            *
*                                                                     *
*     Last change on 09-jun-92                                        *
*                                                                     *
*     Included in the following routines:                             *
*                                                                     *
*            COREVT                                                   *
*            CORRIN                                                   *
*            DISTNU                                                   *
*            DRES                                                     *
*            EVDEEX                                                   *
*            EVENTV                                                   *
*            EVEVAP                                                   *
*            FEREVV                                                   *
*            FERHAV                                                   *
*            INCINI                                                   *
*            NUCEVV                                                   *
*            NUCRIV                                                   *
*            RAKEKV                                                   *
*            RBKEKV                                                   *
*            EVENTQ                                                   *
*            NUCRIN                                                   *
*                                                                     *
*---------------------------------------------------------------------*
*
      PARAMETER ( AMUAMU = 0.93149432  D+00 )
*     PARAMETER ( AMPROT = 0.9382796   D+00 )
      PARAMETER ( AMPROT = 0.93827231  D+00 )
*     PARAMETER ( AMNEUT = 0.9395731   D+00 )
      PARAMETER ( AMNEUT = 0.93956563  D+00 )
      PARAMETER ( AMELEC = AMELCT )
      PARAMETER ( R0NUCL = 1.12        D+00 )
      PARAMETER ( RCCOUL = 1.7         D+00 )
      PARAMETER ( COULPR = 0.001439965 D+00 )
*     PARAMETER ( FERTHO = 15.73       D-09 )
*     PARAMETER ( EXPEBN = 7.D+00 / 3.D+00  )
*     PARAMETER ( BEXC12 = FERTHO * 65.41634134195703D+00 )
      PARAMETER ( FERTHO = 14.33       D-09 )
      PARAMETER ( EXPEBN = 2.39        D+00 )
      PARAMETER ( BEXC12 = FERTHO * 72.40715579499394D+00 )
      PARAMETER ( AMUC12 = AMUAMU - AMELEC / 2.D+00 - BEXC12 / 12.D+00 )
      PARAMETER ( AMHYDR = AMPROT + AMELEC  )
      PARAMETER ( AMHTON = AMHYDR - AMNEUT  )
      PARAMETER ( AMNTOU = AMNEUT - AMUC12  )
      PARAMETER ( AMUCSQ = AMUC12 * AMUC12 )
      PARAMETER ( EBNDAV = 0.5D+00 * (AMPROT + AMNEUT) - AMUC12 )
*   Gammin : threshold for deexcitation gammas production, set to 1 keV
*   (this means that up to 1 keV of energy unbalancing can occur
*    during an event)
      PARAMETER ( GAMMIN = 1.0D-06 )
      PARAMETER ( GAMNSQ = 2.0D+00 * GAMMIN * GAMMIN )
*   Tvepsi : "epsilon" for excitation energy, set to gammin / 100
      PARAMETER ( TVEPSI = GAMMIN / 100.D+00 )
*
      COMMON /FKNUDA/ AV0WEL,     APFRMX,     AEFRMX,     AEFRMA,
     &                RDSNUC,     V0WELL (2), PFRMMX (2), EFRMMX (2),
     &                EFRMAV (2), AMNUCL (2), AMNUSQ (2), EBNDNG (2),
     &                VEFFNU (2), ESLOPE (2), PKMNNU (2), EKMNNU (2),
     &                PKMXNU (2), EKMXNU (2), EKMNAV (2), EKINAV (2),
     &                EXMNAV (2), EKUPNU (2), EXMNNU (2), EXUPNU (2),
     &                ERCLAV (2), ESWELL (2), FINCUP (2), AMRCAV    ,
     &                AMRCSQ    , ATO1O3    , ZTO1O3    , ELBNDE (0:100)
 
+KEEP, NUCGEO
*
*=== nucgeo ===========================================================*
*
*----------------------------------------------------------------------*
*                                                                      *
*     NUClear GEOmetry common:                                         *
*                                                                      *
*     Created on  20  july  1991   by    Alfredo Ferrari & Paola Sala  *
*                                                   Infn - Milan       *
*                                                                      *
*     Last change on 24-mar-93     by    Alfredo Ferrari               *
*                                                                      *
*     Included in the following routines:                              *
*                                                                      *
*                        BIMSEL                                        *
*                        NUCNUC                                        *
*                        NWISEL                                        *
*                        PHDSET                                        *
*                        PIOABS                                        *
*                        PIONUC                                        *
*                        PRENUC                                        *
*                        PREPRE                                        *
*                        RSTSEL                                        *
*                        SBCOMP                                        *
*                        SIGFER                                        *
*                        UMOFIN                                        *
*                                                                      *
*     Description of the variables (NUCGEO):                           *
*                                                                      *
*                        Radtot = total radius of the nucleus          *
*                        Radiu0 = radius of the nucleus constant       *
*                                 density core                         *
*                        Radiu1 = radius at the nucleus skin depth     *
*                                 end                                  *
*                        Rad1o2 = half density radius of the nucleus   *
*                        Skindp = Skin depth of the nucleus ( where    *
*                                 density decreases linearly with the  *
*                                 radius from rhocen to rhoskn,        *
*                                 Radiu1 = Radiu0 + Skindp and         *
*                                 Rad1o2 = Radiu0 + 1/(2 Omalhl)       *
*                                        x Skindp )                    *
*                                 Rhoskn = Rhocen * Alphal             *
*                        Halodp = Halo depth of the nucleus ( where    *
*                                 density decreases linearly with the  *
*                                 radius from rhoskn to 0,             *
*                                 Radtot = Radiu0 + Skindp + Halodp    *
*                        Alphal = fraction of the central density the  *
*                                 transition from skin to halo occurs  *
*                                 at                                   *
*                        Omalhl = 1 - Alphal                           *
*                        Radskn = Radius at which the density would be *
*                                 zero if the skin depth behaviour is  *
*                                 continued (Radskn = Radiu0 + Skindp  *
*                                 / Omalhl)                            *
*                        Skneff = "effective" skin depth corresponding *
*                                 to Radskn, Skneff = Skindp / Omalhl  *
*                        Radpro = equivalent radius of the projectile  *
*                        Bimptr = "true" impact parameter of the proj- *
*                                 ectile (referred to the centre of    *
*                                 the projectile)                      *
*                        Rimptr = "true" radius of the interaction     *
*                                 point (referred to the centre of     *
*                                 the projectile)                      *
*                    X,Y,Zimptr = "true" position of the interaction   *
*                                 point (referred to the centre of     *
*                                 the projectile)                      *
*                        Rhocen = central density of the nucleus       *
*                        Rhocor = density at the transition point from *
*                                 core to skin                         *
*                        Rhoskn = density at the transition point from *
*                                 skin to halo, Rhoskn = Alphal Rhocen *
*                        Rhoimp = density of the nucleus at the "ef-   *
*                                 fective interaction point"           *
*                        Rhoimt = density of the nucleus at the "true" *
*                                 position of the interaction point    *
*                    Pfr,Ekfcen = Maximum Fermi momentum/energy in the *
*                                 central core                         *
*                    Pfr,Ekfpro = Maximum Fermi momentum/energy at the *
*                                 true interaction point for the proj- *
*                                 ectile (they are computed as for nu- *
*                                 cleons without any reduction factor) *
*                    Pfr,Ekfimp = Maximum Fermi momentum/energy at the *
*                                 "effective" interaction point for    *
*                                 the target nucleon                   *
*                    Pfr,Ekfbim = Maximum Fermi momentum/energy at     *
*                                 r = " effective" impact parameter    *
*                                 (Bimpct) for the nucleon with the    *
*                                 deepest well                         *
*                        Vprwll = well depth for the present projectile*
*                                 at the "true" interaction point      *
*                        Bimpct = "effective" impact parameter of the  *
*                                 projectile (referred to the centre   *
*                                 of the target nucleon)               *
*                        Rimpct = "effective" radius of the interac-   *
*                                 tion point (referred to the centre   *
*                                 of the target nucleon)               *
*                    X,Y,Zimpct = "effective" position of the interac- *
*                                 tion point (referred to the centre   *
*                                 of the target nucleon)               *
*                        Wllred = reduction factor to be applied to    *
*                                 the Ipwell well to get the proper    *
*                                 well for the projectile              *
*                        Clmbbr = Coulomb barrier for the present pro- *
*                                 jectile                              *
*                        Rdclmb = radius corresponding to the Coulomb  *
*                                 barrier at which Coulomb effects are *
*                                 supposed to be overcome by the nuc-  *
*                                 lear potential:                      *
*                                     Rdclmb = Clmbbr / (zZe^2)        *
*                        Bfclmb = correction factor for the impact pa- *
*                                 rameter, for boo such that the actual*
*                                 b =< Rdclmb:                         *
*                                  Bfclmb = sqrt ( 1 - Clmbbr/Ekproj ) *
*                        Bfceff = actual correction factor for the imp-*
*                                 act parameter, b = boo / Bfceff      *
*                                 for boo =< Rdclmb x Bfclmb:          *
*                                        Bfceff = Bfclmb               *
*                                 for boo > Rdclmb x Bfclmb:           *
*                                   Bfceff = 1 / ( x + sqrt (1+x^2) )  *
*                                  x = Clmbbr x Rdclmb / (2 Ekproj boo)*
*                        Ipwell = index of the target nucleon well to  *
*                                 be used in computing the one for the *
*                                 projectile                           *
*                                 ( 1 = proton, 2 = neutron )          *
*                        Itncmx = index of the target nucleon with     *
*                                 largest Fermi momentum               *
*                                 ( 1 = proton, 2 = neutron )          *
*                        Kprin  = particle index of the projectile     *
*                        Ntargt = number of target nucleons (2 at max) *
*                        Knucim = particle index of the target nucleon *
*                                 ( 1 = proton, 8 = neutron )          *
*                        Knuci2 = particle index of the 2nd target     *
*                                 nucleon for absorption on a couple   *
*                                 of nucleons                          *
*                                                                      *
*     Description of the variables (NUCPWI):                           *
*                                                                      *
*                        Almbar = Reduced De Broglie wavelength        *
*                        Bimmax = maximum impact parameter (at oo from *
*                                 the nucleus)                         *
*                        Siggeo = Geometrical cross section summed     *
*                                 over all partial waves (assuming     *
*                                 opacity=1 for any l)                 *
*                                 Siggeo = pi ( Almbar(lmax+1) )^2     *
*                        Lllmax = highest partial wave, it corresponds *
*                                 to: Almbar Lllmax >= Bimmax, where   *
*                                 the >= means that the smallest       *
*                                 integer >= Bimmax / Almbar is used   *
*                        Lllact = partial wave index of the present    *
*                                 interaction                          *
*                                                                      *
*----------------------------------------------------------------------*
*
      PARAMETER ( PI    = 3.14159265358979322702D+00 )
      PARAMETER ( PISQ  = 9.86960440108935854694D+00 )
      PARAMETER ( SQRT12 = 3.464101615137755D+00  )
*  This is log(11)/(4log(3)), it is ok for alphal = 0.1, bethal = 0.01 )
      PARAMETER ( SKTOHL = 0.5456645846610345D+00 )
*  This is log(99/19)/(4log(3)), it is ok for alphal = 0.05,
*  bethal = 0.01 )
*     PARAMETER ( SKTOHL = 0.3756286198494407D+00 )
*  This is log(99/4)/(4log(3)), it is ok for alphal = 0.2,
*  bethal = 0.01 )
*     PARAMETER ( SKTOHL = 0.7301997078753058D+00 )
*  This is log(99/4)/(4log(3)), it is ok for alphal = 0.02,
*  bethal = 0.001 )
*     PARAMETER ( SKTOHL = 0.7301997078753058D+00 )
      PARAMETER ( RZNUCL = 1.12        D+00 )
      PARAMETER ( RMSPRO = 0.8         D+00 )
      PARAMETER ( R0PROT = RMSPRO / SQRT12  )
      PARAMETER ( ARHPRO = 1.D+00 / 8.D+00 / PI / R0PROT / R0PROT
     &          / R0PROT )
      PARAMETER ( RLLE04 = RZNUCL )
      PARAMETER ( RLLE16 = RZNUCL )
      PARAMETER ( RLGT16 = RZNUCL )
      PARAMETER ( RCLE04 = 0.75D+00 / PI / RLLE04 / RLLE04 / RLLE04 )
      PARAMETER ( RCLE16 = 0.75D+00 / PI / RLLE16 / RLLE16 / RLLE16 )
      PARAMETER ( RCGT16 = 0.75D+00 / PI / RLGT16 / RLGT16 / RLGT16 )
      PARAMETER ( SKLE04 = 1.4D+00 )
      PARAMETER ( SKLE16 = 1.9D+00 )
      PARAMETER ( SKGT16 = 2.4D+00 )
      PARAMETER ( HLLE04 = SKTOHL * SKLE04 )
      PARAMETER ( HLLE16 = SKTOHL * SKLE16 )
      PARAMETER ( HLGT16 = SKTOHL * SKGT16 )
      PARAMETER ( ALPHA0 = 0.1D+00 )
*2    PARAMETER ( ALPHA0 = 0.05D+00 )
*0    PARAMETER ( ALPHA0 = 0.2D+00 )
*3    PARAMETER ( ALPHA0 = 0.02D+00 )
*4    PARAMETER ( ALPHA0 = 0.25D+00 )
      PARAMETER ( OMALH0 = 1.D+00 - ALPHA0 )
      PARAMETER ( GAMSK0 = 0.9D+00 )
*0    PARAMETER ( GAMSK0 = 0.8D+00 )
*2    PARAMETER ( GAMSK0 = 0.9D+00 )
*3    PARAMETER ( GAMSK0 = 0.9D+00 )
*4    PARAMETER ( GAMSK0 = 0.75D+00 )
      PARAMETER ( OMGAS0 = 1.D+00 - GAMSK0 )
      PARAMETER ( POTME0 = 0.6666666666666667D+00 )
      PARAMETER ( POTBA0 = 1.D+00 )
*  This parameter is the Panofsky ratio
      PARAMETER ( PNFRAT = 1.533D+00 )
*  This parameter set the branching ratio for radiative pi- capture
*  at rest in complex nuclei (it is a bit larger than the experimental
*  one to compensate for Pauli blocking etc etc ). This value is
*  for A=oo
      PARAMETER ( RADPIM = 0.035D+00 )
      PARAMETER ( RDPMHL = 14.D+00   )
*  Probability for pi- absorption to have a second proton in the couple
*  of nucleons ( the first one must be a proton )
      PARAMETER ( APMRST = 4.D+00 / 44.D+00 )
*  Probability for pi- absorption to have a second proton in the couple
*  of nucleons ( the first one must be a proton )
      PARAMETER ( APMPRO = 1.D+00 / 6.D+00 )
*  Probability for pi+ absorption to have a proton in the couple
*  of nucleons ( the first one must be a neutron )
      PARAMETER ( APPPRO = 1.D+00 / 6.D+00 )
*  Probability for pi0 absorption to have a p in the couple
*  as first particle
      PARAMETER ( AP0PFS = 0.5D+00 )
*  Probability for pi0 absorption to have a p in the couple
*  as second particle for a p first particle
      PARAMETER ( AP0PFP = 1.D+00 / 3.D+00 )
*  Probability for pi0 absorption to have a p in the couple
*  as second particle for a n first particle
      PARAMETER ( AP0NFP = 2.D+00 / 3.D+00 )
      PARAMETER ( MXSCIN = 50     )
*
      LOGICAL LABRST, LELSTC, LINELS, LCHEXC, LABSRP, LABSTH
*  NUClear Geometry Input data
      COMMON / FKNUGI / RHOTAB (2:260), RHATAB (2:260), ALPTAB (2:260),
     &                  RADTAB (2:260), SKITAB (2:260), HALTAB (2:260),
     &                  SK3TAB (2:260), SK4TAB (2:260), HABTAB (2:260),
     &                  CWSTAB (2:260), EKATAB (2:260), PFATAB (2:260),
     &                  PFRTAB (2:260)
*  NUClear GEOmetry
      COMMON / FKNUGE / RADTOT, RADIU1, RADIU0, RAD1O2, SKINDP, HALODP,
     &                  ALPHAL, OMALHL, RADSKN, SKNEFF, CPARWS, RADPRO,
     &                  RADCOR, RADCO2, RADMAX, BIMPTR, RIMPTR, XIMPTR,
     &                  YIMPTR, ZIMPTR, RHOIMT, EKFPRO, PFRPRO, RHOCEN,
     &                  RHOCOR, RHOSKN, EKFCEN (2), PFRCEN (2), EKFBIM,
     &                  PFRBIM, RHOIMP, EKFIMP, PFRIMP, EKFIM2, PFRIM2,
     &                  VPRWLL, RIMPCT, BIMPCT, XIMPCT, YIMPCT, ZIMPCT,
     &                  XBIMPC, YBIMPC, ZBIMPC, CXIMPC, CYIMPC, CZIMPC,
     &                  SQRIMP, SIGMAP, SIGMAN, SIGMAA, RHORED, R0TRAJ,
     &                  R1TRAJ, SBUSED, SBTOT , SBRES , RHOAVE, EKFAVE,
     &                  PFRAVE, AVEBIN, ACOLL , ZCOLL , RADSIG, OPACTY,
     &                  EKECON, PNUCCO, EKEWLL, PPRWLL, PXPROJ, PYPROJ,
     &                  PZPROJ, EKFERM, PNFRMI, PXFERM, PYFERM, PZFERM,
     &                  EKFER2, PNFRM2, PXFER2, PYFER2, PZFER2, EKFER3
      COMMON / FKNUGE /
     &                  PNFRM3, PXFER3, PYFER3, PZFER3, RHOMEM, EKFMEM,
     &                  BIMMEM, WLLRED, VPRBIM, POTINC, POTOUT, EEXMIN,
     &                  EEXDEL, EEXANY, CLMBBR, RDCLMB, BFCLMB, BFCEFF,
     &                  BNPROJ, BNDNUC, DEBRLM, SK4PAR, UBIMPC, VBIMPC,
     &                  WBIMPC, BNDPOT, SIGMAT, WLLRES, POTBAR, POTMES,
     &                  HHLP   (2), FORTOT (2), BNENRG (3), DEFNUC (2),
     &                  SIGMPR (3), SIGMNU (3), SIGMAB (3), IPWELL,
     &                  ITNCMX, KPRIN , NTARGT, KNUCIM, KNUCI2, KNUCI3,
     &                  IEVPRE, ISFCOL
*  NUClear Partial Waves Informations
      COMMON / FKNUPW / ALMBAR, BIMMAX, SIGGEO, LLLMAX, LLLACT
*  NUClear Geometry Interaction Informations
      COMMON / FKNUII / HOLEXP (MXSCIN), XEXPIN (MXSCIN),
     &                  YEXPIN (MXSCIN), ZEXPIN (MXSCIN),
     &                  RHOEXP, EKFEXP, EHLFIX,
     &                  NHLEXP, NHLFIX, IPRTYP, ISCTYP (MXSCIN),
     &                  NUSCIN, NEXPEM, LABRST, LELSTC, LINELS, LCHEXC,
     &                  LABSRP, LABSTH
      DIMENSION AWSTAB (2:260)
      EQUIVALENCE ( DEFPRO, DEFNUC (1) )
      EQUIVALENCE ( DEFNEU, DEFNUC (2) )
      EQUIVALENCE ( OMALHL, SK3PAR )
      EQUIVALENCE ( ALPHAL, HABPAR )
      EQUIVALENCE ( ALPTAB (2), AWSTAB (2) )
      EQUIVALENCE ( SIGMPE, SIGMPR (1) )
      EQUIVALENCE ( SIGMPC, SIGMPR (2) )
      EQUIVALENCE ( SIGMPI, SIGMPR (3) )
      EQUIVALENCE ( SIGMNE, SIGMNU (1) )
      EQUIVALENCE ( SIGMNC, SIGMNU (2) )
      EQUIVALENCE ( SIGMNI, SIGMNU (3) )
      EQUIVALENCE ( SIGMA2, SIGMAB (1) )
      EQUIVALENCE ( SIGMA3, SIGMAB (2) )
      EQUIVALENCE ( SIGMAS, SIGMAB (3) )
 
+KEEP, NUCLEV
*
*=== nuclev ===========================================================*
*
*----------------------------------------------------------------------*
*                                                                      *
*     NUClear LEVel common:                                            *
*                                                                      *
*     Created on  10 january 1992  by    Alfredo Ferrari & Paola Sala  *
*                                                   Infn - Milan       *
*                                                                      *
*     Last change on 26-mar-93     by    Alfredo Ferrari               *
*                                                                      *
*     Included in the following routines:                              *
*                                                                      *
*                        BERTTP                                        *
*                        BIMSEL                                        *
*                        NCLVIN                                        *
*                        NCLVGT                                        *
*                        NCLVST                                        *
*                        NUCNUC                                        *
*                        NWISEL                                        *
*                        PFNCLV                                        *
*                        PIOABS                                        *
*                                                                      *
*     Description of the variables (nuclev):                           *
*                                                                      *
*                   paenuc(k,i) = pairing energies (GeV), for i=1 pro- *
*                                 ton pairing energy for Z=k, for i=2  *
*                                 neutron pairing energy for N=k       *
*                   shenuc(k,i) = shell energies (GeV), for i=1 pro-   *
*                                 ton shell energy for Z=k, for i=2    *
*                                 neutron shell energy for N=k         *
*                     defrmi(i) = level spacing at the Fermi level ac- *
*                                 cording to a Fermi gas               *
*                     defmag(i) = extra energy needed to overcome the  *
*                                 gap between the closed shell and the *
*                                 next level for nuclei with magic     *
*                                 numbers of protons or neutrons       *
*                   cumrad(k,i) = sum for j=1,k of 1 /Rj where Ri is   *
*                                 the maximum radius at which can be   *
*                                 found the jth nucleon of type i      *
*                                 (i=1 proton, i=2 neutron)            *
*                        ruspro = maximum radius at which protons can  *
*                                 still be found                       *
*                        rusneu = maximum radius at which neutrons can *
*                                 still be found                       *
*                        juspro = index for flagging that the jth      *
*                                 proton has been already used if      *
*                                 = inuclv                             *
*                        jusneu = index for flagging that the jth      *
*                                 neutron has been already used if     *
*                                 = inuclv                             *
*                        ntapro = number of protons in the target      *
*                        ntaneu = number of neutrons in the target     *
*                        navpro = number of available proton levels in *
*                                 the target                           *
*                        navneu = number of available neutron levels   *
*                                 in the target                        *
*                        nlspro = number of protons in the last level  *
*                        nlsneu = number of neutrons in the last level *
*                        ncopro = number of protons in the core        *
*                        nconeu = number of neutrons in the core       *
*                        nskpro = number of protons in the skin        *
*                        nskneu = number of neutrons in the skin       *
*                        nhapro = number of protons in the halo        *
*                        nhaneu = number of neutrons in the halo       *
*                        nuspro = number of "used" protons             *
*                        nusneu = number of "used" neutrons            *
*                        jmxpro = index  of the highest energy avai-   *
*                                 lable proton                         *
*                        jmxneu = index  of the highest energy avai-   *
*                                 lable neutron                        *
*                        nprnuc = number of presently used nucleons    *
*                                 (max 2)                              *
*                        iprnuc = type of the presently considered     *
*                                 nucleon                              *
*                        jprnuc = index of the presently considered    *
*                                 nucleon                              *
*                        magnum = magic numbers                        *
*                        magpro = last (possibly not filled) proton    *
*                                 shell                                *
*                        magneu = last (possibly not filled) neutron   *
*                                 shell                                *
*                     mgspro(k) = status of the kth proton shell:      *
*                                 -2 not filled but paired             *
*                                 -1 not filled and unpaired           *
*                                  0 filled (paired of course)         *
*                                 +1 originally  filled but now unpai- *
*                                    red                               *
*                     mgsneu(k) = status of the kth neutron shell      *
*                        inuclv = index of the present event           *
*                                                                      *
*----------------------------------------------------------------------*
*
*  NUClear LEVel
      COMMON / FKNULE / PAENUC (200,2), SHENUC (200,2), DEFRMI (2),
     &                  DEFMAG (2), ENNCLV (160,2), RANCLV (160,2),
     &                  CUMRAD (0:160,2), RUSNUC (2),
     &                  ENPLVL (114), ENNLVL(164), JUSNUC (160,2),
     &                  NTANUC (2), NAVNUC (2), NLSNUC (2), NCONUC (2),
     &                  NSKNUC (2), NHANUC (2), NUSNUC (2), JMXNUC (2),
     &                  IPRNUC (2), JPRNUC (2), MAGNUM (8), MAGNUC (2),
     &                  MGSNUC (8,2), MGSSNC (25,2), NSBSHL (2),
     &                  NPRNUC, INUCLV
      DIMENSION JUSPRO (160), JUSNEU (160), MGSPRO (8), MGSNEU (8),
     &          MGSSPR (19) , MGSSNE (25)
      EQUIVALENCE ( RUSNUC (1), RUSPRO )
      EQUIVALENCE ( RUSNUC (2), RUSNEU )
      EQUIVALENCE ( JUSNUC (1,1), JUSPRO (1) )
      EQUIVALENCE ( JUSNUC (1,2), JUSNEU (1) )
      EQUIVALENCE ( MGSNUC (1,1), MGSPRO (1) )
      EQUIVALENCE ( MGSNUC (1,2), MGSNEU (1) )
      EQUIVALENCE ( MGSSNC (1,1), MGSSPR (1) )
      EQUIVALENCE ( MGSSNC (1,2), MGSSNE (1) )
      EQUIVALENCE ( NTANUC (1), NTAPRO )
      EQUIVALENCE ( NTANUC (2), NTANEU )
      EQUIVALENCE ( NAVNUC (1), NAVPRO )
      EQUIVALENCE ( NAVNUC (2), NAVNEU )
      EQUIVALENCE ( NLSNUC (1), NLSPRO )
      EQUIVALENCE ( NLSNUC (2), NLSNEU )
      EQUIVALENCE ( NCONUC (1), NCOPRO )
      EQUIVALENCE ( NCONUC (2), NCONEU )
      EQUIVALENCE ( NSKNUC (1), NSKPRO )
      EQUIVALENCE ( NSKNUC (2), NSKNEU )
      EQUIVALENCE ( NHANUC (1), NHAPRO )
      EQUIVALENCE ( NHANUC (2), NHANEU )
      EQUIVALENCE ( NUSNUC (1), NUSPRO )
      EQUIVALENCE ( NUSNUC (2), NUSNEU )
      EQUIVALENCE ( JMXNUC (1), JMXPRO )
      EQUIVALENCE ( JMXNUC (2), JMXNEU )
      EQUIVALENCE ( MAGNUC (1), MAGPRO )
      EQUIVALENCE ( MAGNUC (2), MAGNEU )
 
+KEEP, NUCPAR
*
*=== nucpar ===========================================================*
*
*
*----------------------------------------------------------------------*
*     Created on 6-9-89 by A. Ferrari                                  *
*                       included in:                                   *
*                                    nucevt                            *
*                                    evxtes                            *
*                                    distnu                            *
*                                    eventq                            *
*----------------------------------------------------------------------*
 
      PARAMETER (MXPNUC=600)
      CHARACTER*8 ANNU
      COMMON /FKNUPA/  PXNU(MXPNUC),   PYNU(MXPNUC),   PZNU(MXPNUC),
     &                HEPNU(MXPNUC),   AMNU(MXPNUC),   ANNU(MXPNUC),
     &                ICHNU(MXPNUC), IBARNU(MXPNUC),  NRENU(MXPNUC)
 
 
+KEEP, NUCSTF
*
*=== nucstf ===========================================================*
*
*----------------------------------------------------------------------*
*                                                                      *
*     NUClear STatement Functions:                                     *
*                                                                      *
*     Created on  14 january 1992  by    Alfredo Ferrari & Paola Sala  *
*                                                   Infn - Milan       *
*                                                                      *
*     Last change on 04-feb-92     by    Alfredo Ferrari               *
*                                                                      *
*     Included in the following routines:                              *
*                                                                      *
*                        FPFRNC                                        *
*                        FRADNC                                        *
*                        FRHINC                                        *
*                        FRHONC                                        *
*                        SBCOMP                                        *
*                                                                      *
*----------------------------------------------------------------------*
*
*  NUClear STatement Functions: nucleus with a costant core and
*  linearly decreasing skin and halo
*  rho (r):
*     Statement functions:
      RHCORE (R) = RHOCEN
      RHSKIN (R) = RHOCEN * ( RADSKN - R ) / SKNEFF
      RHHALO (R) = RHOSKN * ( RADTOT - R ) / HALODP
*  other
*     RHCORE (R) = RHOCEN
*  Skin with a linear and a cubic term:
*     RHSKIN (R) = RHOCEN * ( ( RADSKN - R ) / SKNEFF + SK3PAR * ( R
*    &           - CPARWS )**3 )
*  Skin with a linear, a cubic and a quartic term:
*     RHSKIN (R) = RHOCEN * ( ( RADSKN - R ) / SKNEFF
*    &           + ( R - CPARWS )**3 * ( SK3PAR + SK4PAR
*    &           * ( R - CPARWS ) ) )
*     RHHALO (R) = RHOCEN * HABPAR * ( RADTOT - R )**1.5D+00
* / r      2
* | 4 pi r' rho (r') dr':
* / 0
*     Statement functions:
      RICORE (R) = 4.D+00 * PI / 3.D+00 * RHOCEN * R**3
      RISKIN (R) = RICORE (RADIU0) + 4.D+00 * PI / 3.D+00 * RHOCEN
     &           * ( RADSKN / SKNEFF * ( R**3 - RADIU0**3 )
     &           - 0.75D+00 * ( R**4 - RADIU0**4 ) / SKNEFF )
      RIHALO (R) = RISKIN (RADIU1) + 4.D+00 * PI / 3.D+00 * RHOSKN
     &           * ( RADTOT / HALODP * ( R**3 - RADIU1**3 )
     &           - 0.75D+00 * ( R**4 - RADIU1**4 ) / HALODP )
*  Other:
*     RICORE (R) = 4.D+00 * PI / 3.D+00 * RHOCEN * R**3
*  Skin with a linear and a cubic term:
*     RISKIN (R) = RICORE (RADIU0) + 4.D+00 * PI / 3.D+00 * RHOCEN
*    &           * ( ( RADSKN / SKNEFF - CPARWS**3 * SK3PAR )
*    &           * ( R**3 - RADIU0**3 ) - 0.75D+00 * ( 1.D+00 / SKNEFF
*    &           - 3.D+00 * SK3PAR * CPARWS**2 ) * ( R**4 - RADIU0**4 )
*    &           - 1.8D+00 * SK3PAR * CPARWS * ( R**5 - RADIU0**5 )
*    &           + 0.5D+00 * SK3PAR * ( R**6 - RADIU0**6 ) )
*  Skin with a linear, a cubic and a quartic term:
*     RISKIN (R) = RICORE (RADIU0) + 4.D+00 * PI / 3.D+00 * RHOCEN
*    &           * ( ( RADSKN / SKNEFF - CPARWS**3 * ( SK3PAR - CPARWS
*    &           * SK4PAR ) ) * ( R**3 - RADIU0**3 ) - 0.75D+00
*    &           * ( 1.D+00 / SKNEFF - CPARWS**2 * ( 3.D+00 * SK3PAR
*    &           - 4.D+00 * SK4PAR * CPARWS ) ) * ( R**4 - RADIU0**4 )
*    &           - 1.8D+00 * CPARWS * ( SK3PAR - 2.D+00 * SK4PAR
*    &           * CPARWS ) * ( R**5 - RADIU0**5 )
*    &           - ( 2.D+00 * SK4PAR * CPARWS - 0.5D+00 * SK3PAR )
*    &           * ( R**6 - RADIU0**6 ) + 3.D+00 / 7.D+00 * SK4PAR
*    &           * ( R**7 - RADIU0**7 ) )
*     RIHALO (R) = RISKIN (RADIU1) + 8.D+00 * PI * RHOCEN
*    &           * HABPAR * ( ( 0.2D+00 * RADTOT**2 - 2.D+00 / 7.D+00
*    &           * RADTOT * HALODP + HALODP**2 / 9.D+00 )
*    &           * ( SQRT (HALODP) )**5 - ( 0.2D+00 * RADTOT**2
*    &           - 2.D+00 / 7.D+00 * RADTOT * ( RADTOT - R )
*    &           + ( RADTOT - R )**2 / 9.D+00 )
*    &           * ( RADTOT - R )**2.5D+00 )
*  r (rho):
*     Statement functions:
      RACORE (RHO) = RADIU0
      RASKIN (RHO) = RADSKN - SKNEFF * RHO / RHOCEN
      RAHALO (RHO) = RADTOT - HALODP * RHO / RHOSKN
*  p_f (rho,i), i=1 proton, 2 neutron:
*     Statement functions:
      PFCORE (RHO,I) = PFRCEN (I)
      PFSKIN (RHO,I) = PFRCEN (I) * (RHO/RHOCEN)**0.3333333333333333D+00
      PFHALO (RHO,I) = PFRCEN (I) * (RHO/RHOCEN)**0.3333333333333333D+00
*  end NUClear STatement Functions
 
+KEEP, PAPROPT
      DOUBLE PRECISION AM, AMDISC, THALF,BIASDC, BIASIN
 
+KEEP, PAPROP
*
*=== paprop ===========================================================*
*
*----------------------------------------------------------------------*
*     include file: paprop copy                   created 26/11/86 by p*
*     changes: on  16 december 1992 by Alfredo Ferrari                 *
*     included in the following subroutines or functions: not updated  *
*                                                                      *
*     description of the common block(s) and variable(s)               *
*                                                                      *
*     /paprop/ contains particle properties                            *
*        btype  = literal name of the particle                         *
*        am     = particle mass in gev                                 *
*        ichrge = electric charge of the particle                      *
*        iscore = explanations for the scored distribution             *
*        genpar = names of the generalized particles                   *
*        ijdisc = list of the particle types to be discarded           *
*        thalf  = half life of the particle in sec                     *
*        biasdc = decay biasing factors                                *
*        biasin = inelastic interaction biasing factors                *
*        lhadro = flag for hadrons                                     *
*        jspinp = particle spin (in units of 1/2)                      *
*        lbsdcy = logical flag for biased decay: if .true. the biasing *
*                 factor is used as an upper limit to the decay length *
*        lprbsd = logical flag for biased decay: if .true. the biasing *
*                 factor is applied only to primaries                  *
*        lprbsi = logical flag for inelastic interaction biasing: if   *
*                 .true. the biasing factor is applied only to prima-  *
*                 ries                                                 *
*                                                                      *
*----------------------------------------------------------------------*
*
      LOGICAL LHADRO, LBSDCY, LPRBSD, LPRBSI
      CHARACTER*8 BTYPE,GENPAR
      COMMON / FKPAPR / AM  (NALLWP), AMDISC (NALLWP), THALF  (NALLWP),
     &               BIASDC (NALLWP), BIASIN (NALLWP), ICHRGE (NALLWP),
     &               ISCORE     (10), IJDISC (NALLWP), LHADRO (NALLWP),
     &               JSPINP (NALLWP), LBSDCY (NALLWP), LPRBSD, LPRBSI
      COMMON / FKCHPR / BTYPE  (NALLWP), GENPAR (30)
 
+KEEP, PAREVT
*                                                                      *
*=== parevt ===========================================================*
*                                                                      *
*----------------------------------------------------------------------*
*                                                                      *
*     Created on 28-3-90 by A. Ferrari, INFN - Milan                   *
*                                                                      *
*     Last change  on  20 april  1992    by    Alfredo Ferrari         *
*                                                                      *
*           included in:                                               *
*                          fluka                                       *
*                          bdnopt                                      *
*                          corevt                                      *
*                          distnu                                      *
*                          epilog                                      *
*                          eventv                                      *
*                          evevap                                      *
*                          evvini                                      *
*                          evxtes                                      *
*                          ferevv                                      *
*                          kaskad                                      *
*                          incini                                      *
*                          nucevv                                      *
*                          pmprab                                      *
*           and in     :                                               *
*                          prenuc                                      *
*                          umofin                                      *
*                          bimsel                                      *
*                          nucnuc                                      *
*                          nwisel                                      *
*                          pioabs                                      *
*                          prepre                                      *
*                          rstsel                                      *
*                                                                      *
*           frdiff = fraction of the total number of events which are  *
*                    diffractive ones                                  *
*           pthdff = momentum threshold for diffractive events         *
*                    diffractive ones                                  *
*           fsprd0 = asymptotic reduction factor for cascade particle  *
*                    energy slope parameter                            *
*           fshpfn = modifying factor for bamjet momentum sharing jet  *
*                    function                                          *
*           rn1gsc = correlation factor between shower and grey part-  *
*                    ticle multiplicities                              *
*           rn2gsc = correlation factor between shower and grey part-  *
*                    ticle multiplicities                              *
*           dpower = power exponent used in the binomial distributions *
*                    for grey particles                                *
*           lpower = flag to signal if dpower is different from the    *
*                    default option (dpower=2)                         *
*           ldiffr = flag for particles undergoing diffractive events  *
*           linctv = flag to switch on/off cascade nucleons and exci-  *
*                    tation energy (it is important for testing the    *
*                    generator                                         *
*           levprt = flag for nuclear evaporation                      *
*           ldeexg = flag for nuclear deexcitation gammas              *
*           lgdhpr = flag for geometry dependent calculations in the   *
*                    preequilibrium part                               *
*           lpreex = flag for explicit treatment of the first inte-    *
*                    ctions in the preequilibrium part                 *
*           lhlfix = flag for "freezing" the hole depth of the holes   *
*                    produced in the explicitly treated interactions   *
*                    in the preequilibrium part                        *
*           lprfix = flag for "freezing" the already sampled particle  *
*                    exciton energy in the preequilibrium part         *
*           lparwv = flag to apply the Heisenberg principle according  *
*                    to the reduced DeBroglie wavelength in the calcu- *
*                    lation of the impact parameter and in computing   *
*                    the particle position after interactions          *
*           ilvmod = flag to select the level density option           *
*                                                                      *
*----------------------------------------------------------------------*
*
*
*  30% of events, randomly choosen, are diffractive events!!
*  Now 20% (J. Ranft & A. Ferrari, 25-3-90)
*
      PARAMETER ( FRDIFF = 0.2D+00 )
      PARAMETER ( PTHDFF = 8.5D+00 )
      PARAMETER ( ETHSEA = 1.0D+00 )
 
      LOGICAL LDIFFR, LINCTV, LEVPRT, LHEAVY, LDEEXG, LGDHPR, LPREEX,
     &        LHLFIX, LPRFIX, LPARWV, LPOWER
      COMMON / FKPARE / DPOWER, FSPRD0, FSHPFN, RN1GSC, RN2GSC,
     &                  LDIFFR (39),    LPOWER, LINCTV, LEVPRT, LHEAVY,
     &                  LDEEXG, LGDHPR, LPREEX, LHLFIX, LPRFIX, LPARWV,
     &                  ILVMOD
 
+KEEP, PARNUC
*
*=== parnuc ===========================================================*
*
*----------------------------------------------------------------------*
*                                                                      *
*     Created on  2 august 1991    by    Alfredo Ferrari & Paola Sala  *
*                                                   Infn - Milan       *
*                                                                      *
*     Last change on 25-mar-93     by    Alfredo Ferrari               *
*                                                                      *
*     included in :                                                    *
*                                                                      *
*                   Couset                                             *
*                   Nucnuc                                             *
*                   Nwisel                                             *
*                   Phdset                                             *
*                   Phdwll                                             *
*                   Pioabs                                             *
*                   Pionuc                                             *
*                   Pmprab                                             *
*                   Pncset                                             *
*                   Pncset                                             *
*                   Prenuc                                             *
*                   Prepre                                             *
*                   Sbcomp                                             *
*                   Umofin                                             *
*                                                                      *
*----------------------------------------------------------------------*
*
      PARAMETER ( PIGRK  = PIPIPI )
      PARAMETER ( ALEVEL = 8.D-03 )
*  Standard parameter for central density: it is exactly r0nucl of
*  Parevt
      PARAMETER ( RCNUCL = 1.12D+00 )
*  "Naive" r0 for sigmas
      PARAMETER ( R0SIG  = 1.3D+00 )
*  r0 for sigmas according to Kikuchi & Kawai
      PARAMETER ( R0SIGK = 1.5D+00 )
*  r0 for Coulomb barrier according to Kikuchi & Kawai
      PARAMETER ( RCOULB = 1.5D+00 )
*  Parameter for Coulomb barrier according to Hermes (Evap-5)
      PARAMETER ( COULBH = 0.88235D-03 )
*  Central density in nuclei
      PARAMETER ( RHONU0 = 0.75D+00 / PIGRK / RCNUCL / RCNUCL / RCNUCL )
*  For Taufor, Aefrav & Rhonuc the combinations 1 and 3 are ok. If the
*  Hannes expression for Taufor is used we must use Taufor from
*  combination 3 and Aefrav and Rhonuc from combination 1
*  Combination 3:
*3    PARAMETER ( TAUFOR = 3.0D+00 )
*  Combination 1:
*     PARAMETER ( TAUFOR = 5.0D+00 )
      PARAMETER ( TAUFOR = 10.0D+00 )
*  Thresholds for explicit interactions:
*    Primary projectile:
      PARAMETER ( EKEEXP = 0.03D+00 )
*    Secondary nucleons:
      PARAMETER ( EKREXP = 0.05D+00 )
*    Just for Pauli checks:
      PARAMETER ( EKEMNM = 0.01D+00 )
*
      PARAMETER ( NCPMX = 50 )
      COMMON / FKPARN / EKORI , PXORI , PYORI , PZORI , PTORI ,
     &                  ENNUC  (NCPMX), PNUCL  (NCPMX), EKFNUC (NCPMX),
     &                  XSTNUC (NCPMX), YSTNUC (NCPMX), ZSTNUC (NCPMX),
     &                  PXNUCL (NCPMX), PYNUCL (NCPMX), PZNUCL (NCPMX),
     &                  RSTNUC (NCPMX), RHNUCL (NCPMX), FREEPA (NCPMX),
     &                  CRRPAN (NCPMX), CRRPAP (NCPMX), BSTNUC (NCPMX),
     &                  WLRNUC (NCPMX), BNDGAV, DEFMIN, KPNUCL (NCPMX),
     &                  KRFNUC (NCPMX), KPORI , IBORI , IBNUCL, NPNUC ,
     &                  INUCTS (NCPMX), NNUCTS, ISFNUC (NCPMX)
 
+KEEP, PARTT
      DOUBLE PRECISION AM, GA, TAU, AMDISC
 
+KEEP, PART
*
*=== part =============================================================*
*
*----------------------------------------------------------------------*
*     Include file: part copy         Revised on 20-7-90 by A. Ferrari *
*     Note: see also part2 copy and part3 copy                         *
*     Changes: none                                                    *
*     Included in the following subroutines or functions: not updated  *
*                                                                      *
*     Description of the common block(s) and variable(s)               *
*                                                                      *
*         Kptoip = conversion from part to paprop numbering            *
*         Iptokp = conversion from paprop to part numbering            *
*                                                                      *
*----------------------------------------------------------------------*
*
      PARAMETER (IDMAX8=183)
      CHARACTER*8  ANAME
      COMMON / FKPART / AM   (IDMAX8), GA     (IDMAX8), TAU    (IDMAX8),
     &                AMDISC (IDMAX8), ICH    (IDMAX8), IBAR   (IDMAX8),
     &                K1     (IDMAX8), K2     (IDMAX8), KPTOIP (IDMAX8),
     &                IPTOKP (39)
      COMMON / FKCHPA / ANAME (IDMAX8)
 
+KEEP, PART2T
      DOUBLE PRECISION AAM, GA, TAU, AAMDSC
 
+KEEP, PART2
*
*=== part2 ============================================================*
*
*----------------------------------------------------------------------*
*     Include file: part2 copy        Revised on 20-7-90 by A. Ferrari *
*     Note: see also part copy and part3 copy                          *
*     Changes: none                                                    *
*     Included in the following subroutines or functions: not updated  *
*                                                                      *
*     Description of the common block(s) and variable(s)               *
*                                                                      *
*         Kptoip = conversion from part to paprop numbering            *
*         Iptokp = conversion from paprop to part numbering            *
*                                                                      *
*----------------------------------------------------------------------*
*
      PARAMETER (IDMAX8=183)
      CHARACTER*8  ANAME
      COMMON / FKPART / AAM  (IDMAX8), GA     (IDMAX8), TAU    (IDMAX8),
     &                AAMDSC (IDMAX8), IICH   (IDMAX8), IIBAR  (IDMAX8),
     &                K1     (IDMAX8), K2     (IDMAX8), KPTOIP (IDMAX8),
     &                IPTOKP (39)
      COMMON / FKCHPA / ANAME (IDMAX8)
 
+KEEP, PART3
*
*=== part3 ============================================================*
*
*----------------------------------------------------------------------*
*     Include file: part3 copy        Revised on 20-7-90 by A. Ferrari *
*     Note: see also part copy and part2 copy                          *
*     Changes: none                                                    *
*     Included in the following subroutines or functions: not updated  *
*                                                                      *
*     Description of the common block(s) and variable(s)               *
*                                                                      *
*         Kptoip = conversion from part to paprop numbering            *
*         Iptokp = conversion from paprop to part numbering            *
*                                                                      *
*----------------------------------------------------------------------*
*
      PARAMETER (IDMAX8=183)
      CHARACTER*8  ANAMC
      COMMON / FKPART / AMC  (IDMAX8), GAC    (IDMAX8), TAUC   (IDMAX8),
     &                AMCDSC (IDMAX8), ICHC   (IDMAX8), IBARC  (IDMAX8),
     &                K1C    (IDMAX8), K2C    (IDMAX8), KPTOIP (IDMAX8),
     &                IPTOKP (39)
      COMMON / FKCHPA / ANAMC (IDMAX8)
 
+KEEP, QQUARK
*
*=== qquark ===========================================================*
*
*----------------------------------------------------------------------*
*                                                                      *
*     Created on    6 february 1991    by        Alfredo Ferrari       *
*                                                  INFN - Milan        *
*                                                                      *
*     Last change  on  6 february 1991  by       Alfredo Ferrari       *
*                                                                      *
*     Included in the following routines :                             *
*                                                                      *
*                     COREVT                                           *
*                     CORRIN                                           *
*                     HADEVV                                           *
*                     HADEVT                                           *
*                     NUCEVV                                           *
*                     NUCEVT                                           *
*                                                                      *
*     Quark content of particles:                                      *
*          index   quark   el. charge  bar. charge  isospin  isospin3  *
*              1 = u          2/3          1/3        1/2       1/2    *
*             -1 = ubar      -2/3         -1/3        1/2      -1/2    *
*              2 = d         -1/3          1/3        1/2      -1/2    *
*             -2 = dbar       1/3         -1/3        1/2       1/2    *
*              3 = s         -1/3          1/3         0         0     *
*             -3 = sbar       1/3         -1/3         0         0     *
*              4 = c          2/3          1/3         0         0     *
*             -4 = cbar      -2/3         -1/3         0         0     *
*              5 = b         -1/3          1/3         0         0     *
*             -5 = bbar       1/3         -1/3         0         0     *
*              6 = t          2/3          1/3         0         0     *
*             -6 = tbar      -2/3         -1/3         0         0     *
*                                                                      *
*         Mquark = particle quark composition (Paprop numbering)       *
*         Iqechr = electric charge ( in 1/3 unit )                     *
*         Iqbchr = baryonic charge ( in 1/3 unit )                     *
*         Iqichr = isospin ( in 1/2 unit ), z component                *
*         Iqschr = strangeness                                         *
*         Iqcchr = charm                                               *
*         Iquchr = beauty                                              *
*         Iqtchr = ......                                              *
*                                                                      *
*----------------------------------------------------------------------*
*
      COMMON / FKQUAR / IQECHR (-6:6), IQBCHR (-6:6), IQICHR (-6:6),
     &                  IQSCHR (-6:6), IQCCHR (-6:6), IQUCHR (-6:6),
     &                  IQTCHR (-6:6), MQUARK (3,39)
 
+KEEP, REAC
*
*=== reac =============================================================*
*
*----------------------------------------------------------------------*
*                                                                      *
*     Created on 10 december 1991  by    Alfredo Ferrari & Paola Sala  *
*                                                   Infn - Milan       *
*                                                                      *
*     Last change on 10-dec-91     by    Alfredo Ferrari               *
*                                                                      *
*     This is the original common reac of Hadrin                       *
*                                                                      *
*     Included in the following routines:                              *
*                                                                      *
*                CALUMV                                                *
*                DATESH                                                *
*                HADRIV                                                *
*                RCHANV                                                *
*                BLKDT3                                                *
*                HADRIN                                                *
*                IEFUN                                                 *
*                SIGINT                                                *
*                CALUMO                                                *
*                RCHANW                                                *
*                                                                      *
*----------------------------------------------------------------------*
*
      COMMON /FKREAC/ UMO   ( 296), PLABF ( 296), SIIN  ( 296),
     +              WK    (5184), NRK  (2,268), NURE  (30,2)
 
+KEEP, REDVER
*
*=== redver ===========================================================*
*
*----------------------------------------------------------------------*
*                                                                      *
*     Created on 10 december 1991  by    Alfredo Ferrari & Paola Sala  *
*                                                   Infn - Milan       *
*                                                                      *
*     Last change on 10-dec-91     by    Alfredo Ferrari               *
*                                                                      *
*     This is the original common redver of Hadrin                     *
*                                                                      *
*     Included in the following routines:                              *
*                                                                      *
*                CALUMV                                                *
*                DATESH                                                *
*                HADRIV                                                *
*                RCHANV                                                *
*                BLKDT4                                                *
*                HADRIN                                                *
*                IEFUN                                                 *
*                SIGINT                                                *
*                CALUMO                                                *
*                RCHANW                                                *
*                                                                      *
*----------------------------------------------------------------------*
*
      COMMON / FKREDV / THRESH (268), IRII (17) , IKII (17) , IEII (17)
 
+KEEP, RESNUC
*                                                                     *
*=== resnuc ==========================================================*
*                                                                     *
*---------------------------------------------------------------------*
*                                                                     *
*     Include file Resnuc                                             *
*                                                                     *
*     Created on 20 april 1990  by            Alfredo Ferrari         *
*                                               INFN Milan            *
*                                                                     *
*     Last change on  9  march  1993                                  *
*                                                                     *
*     Included in the following routines:                             *
*                                                                     *
*            BDNOPT                                                   *
*            COREVT                                                   *
*            CORRIN                                                   *
*            DISTNU                                                   *
*            DRES                                                     *
*            EVDEEX                                                   *
*            EVENTQ                                                   *
*            EVENTV                                                   *
*            EVEVAP                                                   *
*            FEREVV                                                   *
*            FERHAV                                                   *
*            LOWRES                                                   *
*            NUCEVT                                                   *
*            NUCEVV                                                   *
*            NUCRIN                                                   *
*            NUCRIV                                                   *
*                                                                     *
*---------------------------------------------------------------------*
*
      LOGICAL LRNFSS
      COMMON /FKRESN/  AMNTAR, AMMTAR, AMNZM1, AMMZM1, AMNNM1, AMMNM1,
     &                   ANOW,   ZNOW, ANCOLL, ZNCOLL,   ERES,  EKRES,
     &                 AMNRES, AMMRES,  PTRES,  PXRES,  PYRES,  PZRES,
     &                 PTRES2,  KTARP,  KTARN, IGREYP, IGREYN,  ICRES,
     &                  IBRES, IEVAPL, IEVAPH, IEVNEU, IEVPRO, IEVDEU,
     &                 IEVTRI, IEV3HE, IEV4HE, IDEEXG,  IBTAR, ICHTAR,
     &                 IOTHER, LRNFSS
 
+KEEP, SPLIT
*
*=== split ============================================================*
*
*----------------------------------------------------------------------*
*                                                                      *
*     Created on 10 december 1991  by    Alfredo Ferrari & Paola Sala  *
*                                                   Infn - Milan       *
*                                                                      *
*     Last change on 10-dec-91     by    Alfredo Ferrari               *
*                                                                      *
*     This is the original common split of Hadrin                      *
*                                                                      *
*     Included in the following routines:                              *
*                                                                      *
*                CALUMV                                                *
*                DATESH                                                *
*                HADRIV                                                *
*                RCHANV                                                *
*                BLKDT3                                                *
*                HADDEN                                                *
*                CALUMO                                                *
*                RCHANW                                                *
*                                                                      *
*----------------------------------------------------------------------*
*
      COMMON / FKSPLI  / WT     (460), NZK  (460,3)
 
+KEEP, XSEPAR
*
*=== xsepar ===========================================================*
*
*----------------------------------------------------------------------*
*                                                                      *
*     Xsec Parameters for neutrons and protons:                        *
*                                                                      *
*     Created on  20 september 1991  by  Alfredo Ferrari & Paola Sala  *
*                                                   Infn - Milan       *
*                                                                      *
*     Last change on 20-sep-91     by    Alfredo Ferrari               *
*                                                                      *
*     Included in the following routines:                              *
*                                                                      *
*                        BERRTP                                        *
*                        XSINEU                                        *
*                        XSIPRO                                        *
*                        PREPRE                                        *
*                                                                      *
*----------------------------------------------------------------------*
*
      COMMON / FKXSEP / AANXSE (100), BBNXSE (100), CCNXSE (100),
     &                  DDNXSE (100), EENXSE (100), ZZNXSE (100),
     &                  EMNXSE (100), XMNXSE (100),
     &                  AAPXSE (100), BBPXSE (100), CCPXSE (100),
     &                  DDPXSE (100), EEPXSE (100), FFPXSE (100),
     &                  ZZPXSE (100), EMPXSE (100), XMPXSE (100)
 
+KEEP, EVA0
*                                                                      *
*=== eva0 =============================================================*
*                                                                      *
      COMMON / FKEVA0 / Y0, B0, P0 (1001), P1 (1001), P2 (1001),
     *                FLA (6), FLZ (6), RHO (6), OMEGA (6), EXMASS (6),
     *                CAM2 (130), CAM3 (200), CAM4 (130), CAM5 (200),
     *                T (4,7), RMASS (297), ALPH (297), BET (297),
     *                WAPS (250,11), APRIME (250), IA (6), IZ (6)
 
+KEEP, EVA1
*                                                                      *
*=== eva1 =============================================================*
*                                                                      *
      COMMON /FKEVA1/ NPART(6),EPART(100,6),COSEVP(3,100,6),HEVSUM
 
+KEEP, FORCN
*                                                                      *
*=== forcn ============================================================*
*                                                                      *
      COMMON /FKFORC/ FKEY
 
+KEEP, HETC5
*                                                                      *
*=== hetc5 ============================================================*
*                                                                      *
      COMMON /FKHET5/ APR,ZPR,EX,UU,EREC
 
+KEEP, HETC7
*                                                                      *
*=== hetc7 ============================================================*
*                                                                      *
      COMMON /FKHET7/ COSKS,SINKS, COSTH,SINTH, COSPHI,SINPHI
 
+KEEP, HETTP
*                                                                      *
*=== hettp ============================================================*
*                                                                      *
      COMMON /FKHETP/  NHSTP,NBERTP,IOSUB,INSRS
 
+KEEP, INPFLG
*                                                                      *
*=== inpflg ===========================================================*
*                                                                      *
      COMMON /FKINPF/ IANG,IFISS,IB0,IGEOM,ISTRAG,KEYDK
 
+KEEP, LABCOS
*                                                                      *
*=== labcos ===========================================================*
*                                                                      *
      COMMON /FKLABC/ COSLBP(3),COSLBR(3)
 
+KEEP, AADAT
*                                                                      *
*=== aadat ============================================================*
*                                                                      *
      PARAMETER (IPROM = 100)
      PARAMETER (ITARM = 100)
      COMMON/FKAADA/ENPERN,PLPERN,SIGAA(IPROM,ITARM),SIGNN,TMASS,AAEVNO,
     +             SELAA(IPROM,ITARM),RLASTP(IPROM,ITARM),
     +             MATPRO,MATTAR,LASTM,IPROA,IPROZ,ITARA,ITARZ
+PATCH,PAMEND. 
*
